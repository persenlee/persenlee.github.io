<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>iOSå±•ç¤º3Dæ¨¡å‹åŠæ€è€ƒ</title>
      <link href="2021/04/30/iOS%E5%B1%95%E7%A4%BA3D%E6%A8%A1%E5%9E%8B%E5%8F%8A%E6%80%9D%E8%80%83/"/>
      <url>2021/04/30/iOS%E5%B1%95%E7%A4%BA3D%E6%A8%A1%E5%9E%8B%E5%8F%8A%E6%80%9D%E8%80%83/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>3Dæ¨¡å‹åœ¨æ¸¸æˆä¸­åº”ç”¨å¹¿æ³›ï¼Œä¸è¿‡åœ¨ç”µå•†Appé‡Œçš„äº§å“åŒ–åº”ç”¨å¹¶ä¸å¤šã€‚ç›®å‰èƒ½å¤Ÿçœ‹åˆ°çš„å¦‚<a href="https://ar.jd.com" target="_blank" rel="noopener">äº¬ä¸œARæ‰«</a>ã€å¾—ç‰©è™šæ‹Ÿè¯•ç©¿ã€IKEA Placeã€æ·˜å®äººç”Ÿç­‰ã€‚åº”ç”¨ä¸å¤šçš„åŸå› ä¸€æ–¹é¢æ˜¯è§†é¢‘å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†3Dæ˜¾ç¤ºçš„éœ€æ±‚ï¼Œå¦ä¸€æ–¹é¢3Dæ¨¡å‹ç”Ÿæˆè¿˜æ²¡æœ‰æˆç†Ÿçš„æ™ºèƒ½åŒ–æ–¹æ¡ˆã€‚ä¸è¿‡3Dæ¨¡å‹åŠåœ¨ARä¸Šåº”ç”¨æ˜¯éå¸¸æœ‰å‰æ™¯çš„ï¼Œå¯¹æ¶ˆè´¹å†³ç­–æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚å°¤å…¶åƒä¸œå®¶è¿™æ ·çš„ç¾å­¦ç”µå•†å¹³å°ï¼Œåœ¨ç‰çŸ³ç å®ã€æ–‡ç©ã€å®¶å±…ã€æœé¥°ã€è‰ºæœ¯å“ç±»ç›®ä¸Šä¼šæœ‰å¾ˆå¥½çš„ç»“åˆç‚¹ã€‚ä¾‹å¦‚ç å®è¯•æˆ´ã€æœé¥°è¯•ç©¿ã€æ–‡ç©å®¶å±…ARåœºæ™¯æ”¾ç½®ç­‰ç­‰ã€‚</p><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>demoæ¼”ç¤ºçš„æ˜¯ä¸€å¼ åºŠè¾¹æ¡Œå­ï¼Œä»¥åŠå¯ä»¥åˆ‡æ¢4ç§ä¸åŒçš„è¡¨é¢æè´¨ã€‚<a href="https://www.cgtrader.com/free-3d-models/interior/bedroom/nightstand-6449d812-f58b-4500-97e8-44d061591899" target="_blank" rel="noopener">æ¨¡å‹</a>æ¥è‡ªäºcgtraderã€‚</p><p>æ¨¡å‹çš„æ–‡ä»¶æ ¼å¼ï¼Œéœ€è¦æ³¨æ„Xcodeå…¼å®¹é—®é¢˜ï¼Œå‚è€ƒğŸ‘‰<a href="https://developer.apple.com/documentation/modelio/mdlasset/1391813-canimportfileextension" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>æ¨èä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Universal_Scene_Description" target="_blank" rel="noopener">usdz</a>(Appleå’Œ<a href="https://en.wikipedia.org/wiki/Pixar" target="_blank" rel="noopener">Pixar</a>åˆä½œå¼€å‘çš„3Dæ–‡ä»¶æ ¼å¼)</p><p>è¿™è¾¹ä¸‹è½½çš„æ˜¯<a href="https://zh.wikipedia.org/wiki/Wavefront_.objæ–‡ä»¶" target="_blank" rel="noopener">obj</a> æ–‡ä»¶ï¼Œä¸è¦å¿˜è®°ä¸€èµ·ä¸‹è½½<a href="https://people.sc.fsu.edu/~jburkardt/data/mtl/mtl.html" target="_blank" rel="noopener">.mtl</a>æ–‡ä»¶(æè´¨åº“æ–‡ä»¶ï¼Œæè¿°çš„æ˜¯ç‰©ä½“çš„æè´¨ä¿¡æ¯)åŠå¯¹åº”çš„æè´¨èµ„æºã€‚</p><p>å¦‚æœåœ¨Xcode Scene Editorä¸­æ— æ³•æ˜¾ç¤ºé¢„æœŸçš„æ¨¡å‹ï¼Œè¿™æ—¶å€™éœ€è¦æ£€æŸ¥ä¸‹.mtlæ–‡ä»¶é‡Œè·¯å¾„æ˜¯å¦é…ç½®æ­£ç¡® ä»¥åŠ çº¹ç†è´´å›¾çš„æ¨¡å¼æ˜¯å¦æ­£ç¡®ã€‚</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>å…·ä½“ä»£ç ä¸åœ¨è¿™é‡Œèµ˜è¿°äº†ï¼Œå‚è€ƒğŸ‘‰<a href="https://github.com/persenlee/3DViewer" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h3><p><img src="https://i.loli.net/2021/04/26/fcks5pETvzP8Mgt.gif" alt="iOSå±•ç¤º3Dæ¨¡å‹demoæ¼”ç¤º.gif"></p><h2 id="äº§å“åŒ–æ€è€ƒğŸ¤”"><a href="#äº§å“åŒ–æ€è€ƒğŸ¤”" class="headerlink" title="äº§å“åŒ–æ€è€ƒğŸ¤”"></a>äº§å“åŒ–æ€è€ƒğŸ¤”</h2><h3 id="3Dæ¨¡å‹ç”Ÿæˆ"><a href="#3Dæ¨¡å‹ç”Ÿæˆ" class="headerlink" title="3Dæ¨¡å‹ç”Ÿæˆ"></a>3Dæ¨¡å‹ç”Ÿæˆ</h3><p>3Dæ¨¡å‹å¦‚ä½•é«˜è´¨é‡ï¼Œæ‰¹é‡åŒ–çš„ç”Ÿæˆå¯¹äºä¸šåŠ¡è½åœ°æ˜¯å¾ˆå…³é”®ä¸€ç¯ï¼Œæ²¡æœ‰3Dæ¨¡å‹ï¼Œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šã€‚</p><p>ä¸‹é¢ğŸ‘‡ç½—åˆ—äº†å‡ ç§3Dæ¨¡å‹ç”Ÿæˆçš„æ–¹å¼å’Œå¯¹åº”çš„ä¼˜ç¼ºç‚¹ï¼Œç»¼åˆä¸‹æ¥ä½¿ç”¨ä¸“ä¸š3Dæ‰«æä»ªè·å–3Dæ¨¡å‹æ•°æ® æ˜¯æ¯”è¾ƒå¥½çš„ä¸€ç§é€”å¾„ï¼Œä¸è¿‡å…·ä½“ç»“æœè¿˜éœ€è¦å®é™…éªŒè¯ã€‚</p><ol><li>å¸‚é¢ä¸Šæœ‰å¾ˆå¤š3Dæ¨¡å‹å…±äº«å’Œäº¤æ˜“å¹³å°ï¼Œå¦‚<a href="https://sketchfab.com" target="_blank" rel="noopener">sketchfab</a>ã€<a href="https://www.turbosquid.com/Search/3D-Models/free" target="_blank" rel="noopener">tubosquid</a>ã€<a href="https://www.cgtrader.com/free-3d-models" target="_blank" rel="noopener">cgtrader</a>ã€‚å¯ä»¥è·å¾—ä¸€äº›æµ‹è¯•ç”¨3Dæ¨¡å‹ï¼Œä¸è¿‡äº§å“åŒ–æ¨¡å‹å°±æ— èƒ½ä¸ºåŠ›äº†ï¼Œé™¤éé€šè¿‡äº¤æ˜“å®šåˆ¶åŒ–å¼€å‘ã€‚</li><li>ä½¿ç”¨å¤šå¼ å›¾ç‰‡ç”Ÿæˆ3Dæ¨¡å‹ï¼Œå¦‚deepmind <a href="https://github.com/deepmind/deepmind-research/tree/master/polygen" target="_blank" rel="noopener">PolyGen</a>ã€adobe <a href="https://labs.adobe.com/projects/scantastic/" target="_blank" rel="noopener">Scantastic</a>ã€ç­‰ï¼Œå¯ä»¥å®ç°ç®€å•æ¨¡å‹åŒ–ã€æˆæœ¬ä½ã€ä½†è¿˜å¤„äºå®éªŒé˜¶æ®µã€‚</li><li>ä¸“ä¸šçš„3dæ‰«æä»ªï¼Œå¦‚<a href="https://www.creaform3d.com/en" target="_blank" rel="noopener">Creaform</a>ã€<a href="https://www.einscan.com" target="_blank" rel="noopener">Einscan</a>ã€ç­‰ï¼Œè·å–é«˜è´¨é‡3Dæ¨¡å‹æ•°æ®ã€‚</li><li>ä½¿ç”¨æ™¯æ·±æ‘„åƒå¤´æˆ–LiDarçš„Appï¼Œå¦‚shapr 3Dã€Qloneã€Polycamã€Scandy Proï¼Œè´¨é‡ä¸Šéš¾ä»¥ä¿éšœã€‚</li><li>é€šè¿‡æµ‹é‡æ•°æ®ï¼Œåˆ©ç”¨3Då»ºæ¨¡è½¯ä»¶æ‰‹åŠ¨å»ºæ¨¡ã€‚è¿™ç§æ–¹å¼æˆæœ¬æé«˜ã€æ•ˆç‡ä½ã€‚</li></ol><h3 id="æ¨¡å‹åˆ†å‘"><a href="#æ¨¡å‹åˆ†å‘" class="headerlink" title="æ¨¡å‹åˆ†å‘"></a>æ¨¡å‹åˆ†å‘</h3><p>åŸºäº<strong>PBR</strong>ï¼ˆç‰©ç†å…‰ç…§ï¼‰3Dæ¨¡å‹ä¸­å¾€å¾€åŒ…å«é«˜æ¸…çš„æè´¨å›¾ç‰‡ï¼Œå› æ­¤æ¨¡å‹å¤§å°åŸºæœ¬éƒ½åœ¨å‡ å…†ä»¥ä¸Šã€‚</p><p>å¦‚æœåªæ˜¯åšå•ä¸€å•†å“çš„æ¼”ç¤ºï¼Œå¯ä»¥æŠŠ3Dæ¨¡å‹æ”¾åœ¨å‘è¡ŒåŒ…é‡Œã€‚</p><p>ä¹‹ååšè§„æ¨¡åŒ–çš„åº”ç”¨å°±è¦è€ƒè™‘åˆ°æ¨¡å‹åˆ†å‘çš„é—®é¢˜ï¼Œ</p><p>ä¸€ç§ç®€å•çš„è§£å†³æ–¹å¼ä½¿ç”¨Appleçš„<a href="https://developer.apple.com/augmented-reality/quick-look/" target="_blank" rel="noopener">AR Quick Look</a>é›†æˆåˆ°appæˆ–è€…h5é¡µé¢ç›´æ¥é¢„è§ˆARæ¨¡å‹ï¼ŒAndroidå¯ä»¥é‡‡ç”¨ARCoreå®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚</p><p>å¦ä¸€ç§å¤æ‚ä½†è‡ªä¸»æ€§æ›´ä½³çš„æ–¹å¼ï¼Œå®¢æˆ·ç«¯éœ€è¦æ”¯æŒä¸€å¥—æ¨¡å‹èµ„æºä¸‹è½½ï¼Œç¼“å­˜ï¼Œæ›´æ–°çš„ç­–ç•¥ã€‚è¿™é‡Œä¸å›¾ç‰‡çš„ç­–ç•¥å­˜åœ¨ä¸€å®šçš„å·®åˆ«ã€‚</p><p>è‡³äºæœåŠ¡ç«¯æ–¹é¢å¤„ç†æ–¹å¼ä¸å›¾ç‰‡ã€è§†é¢‘ä¸Šä¼ æ–¹å¼ç±»ä¼¼ã€‚</p><h3 id="AR"><a href="#AR" class="headerlink" title="AR"></a>AR</h3><p>Appleä¸€ç›´åœ¨ARæ–¹é¢æ·±è€•ï¼ŒARKitä»å‘å¸ƒåˆ°ç°åœ¨ARKit 4ã€æ–°çš„ARå·¥å…·RealityKitï¼Œç¡¬ä»¶æ–¹é¢ä¹Ÿåœ¨åŠ å¼ºä»æ·±æ„Ÿé•œå¤´ã€LiDARã€UWBå®šä½ï¼ˆAirtagï¼‰ã€Airpods proç©ºé—´éŸ³é¢‘ã€‚</p><p>3Dæ¨¡å‹æ˜¾ç¤ºåªæ˜¯æœ€åŸºæœ¬çš„åº”ç”¨ï¼ŒçŠ¹å¦‚3Dæ¸¸æˆä¸€æ ·ã€‚çœŸæ­£èƒ½è®©3Då‘æŒ¥æ›´å¤§èƒ½åŠ›å°±æ˜¯ARä¸MLç»“åˆï¼Œåˆ›é€ å‡ºä¸°å¯Œçš„åº”ç”¨åœºæ™¯ã€‚ç°é˜¶æ®µçš„ARè¯•ç©¿ã€shapr 3Dç”Ÿæˆä¸‰ç»´å›¾çº¸ã€‚</p><p>ç»“åˆä¸œå®¶ä¸å…¶ä»–ç”µå•†å¹³å°çš„æƒ…å†µï¼Œç°é˜¶æ®µé€šè¿‡è™šæ‹Ÿè¯•ç©¿ï¼Œå¢å¼ºç°å®ä½“éªŒæ„Ÿã€åˆºæ¿€æ¶ˆè´¹è€…ä¸‹å•è´­ä¹°ã€é™ä½é€€è´§ç‡ï¼Œæ˜¯ä¸€ç§ä¼˜è´¨çš„æœåŠ¡ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://medium.com/@litoarias/scenekit-to-show-3d-content-in-swift-5-5253afbe63b1" target="_blank" rel="noopener">https://medium.com/@litoarias/scenekit-to-show-3d-content-in-swift-5-5253afbe63b1</a></p><p><a href="https://juejin.cn/post/6844903532693291021" target="_blank" rel="noopener">https://juejin.cn/post/6844903532693291021</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Swiftæ—¥å¿—é‡‡é›†API</title>
      <link href="2021/03/31/Swift%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86API/"/>
      <url>2021/03/31/Swift%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86API/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›éš¾ä»¥è°ƒè¯•ï¼Œæ— æ³•é‡ç°çš„bugã€‚ä½¿ç”¨æ—¥å¿—é‡‡é›†APIå¯ä»¥è·å¾—ä¸€äº›çº¿ç´¢ï¼Œå¸®åŠ©æˆ‘ä»¬è§£å†³ç–‘éš¾æ‚ç—‡ã€‚</p><p>å…¶å®åœ¨iOS10å°±æœ‰ç›¸å…³APIå¯ä»¥å‘æ—¥å¿—ç³»ç»Ÿå‘é€ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯os_log</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">#define os_log(log, format, ...)<br></code></pre></td></tr></table></figure><p>ä¸è¿‡æ–°ç‰ˆæœ¬APIï¼Œæä¾›äº†æ›´åŠ å¼ºå¤§çš„èƒ½åŠ›ã€‚</p><h3 id="å¦‚ä½•é‡‡é›†æ˜¾ç¤º"><a href="#å¦‚ä½•é‡‡é›†æ˜¾ç¤º" class="headerlink" title="å¦‚ä½•é‡‡é›†æ˜¾ç¤º"></a>å¦‚ä½•é‡‡é›†æ˜¾ç¤º</h3><h4 id="ç»ˆç«¯å‘½ä»¤è¡Œ"><a href="#ç»ˆç«¯å‘½ä»¤è¡Œ" class="headerlink" title="ç»ˆç«¯å‘½ä»¤è¡Œ"></a>ç»ˆç«¯å‘½ä»¤è¡Œ</h4><p>è¿ä¸Šè®¾å¤‡åï¼Œæ‰§è¡Œlog collectå‘½ä»¤ï¼Œæ”¶é›†å®Œæˆåä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª.logarchiveçš„æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶å¯ä»¥åœ¨Consoleåº”ç”¨ä¸­è¿›è¡Œæµè§ˆ</p><h4 id="Consoleï¼ˆæ§åˆ¶å°ï¼‰"><a href="#Consoleï¼ˆæ§åˆ¶å°ï¼‰" class="headerlink" title="Consoleï¼ˆæ§åˆ¶å°ï¼‰"></a>Consoleï¼ˆæ§åˆ¶å°ï¼‰</h4><p>è¿ä¸Šè®¾å¤‡åï¼Œæ‰“å¼€Consoleåº”ç”¨ï¼Œé€‰ä¸­ç›®æ ‡è®¾å¤‡ï¼Œå°±å¯ä»¥é‡‡é›†åˆ°ç›¸å…³æ—¥å¿—å¹¶æµè§ˆ</p><p><img src="https://i.loli.net/2021/04/07/KfWyCRcjMnqrwQ4.png" alt="WX20210331-215136@2x.png"></p><h3 id="å¼ºå¤§çš„èƒ½åŠ›"><a href="#å¼ºå¤§çš„èƒ½åŠ›" class="headerlink" title="å¼ºå¤§çš„èƒ½åŠ›"></a>å¼ºå¤§çš„èƒ½åŠ›</h3><h4 id="æ”¯æŒå¤šç§æ•°æ®ç±»å‹"><a href="#æ”¯æŒå¤šç§æ•°æ®ç±»å‹" class="headerlink" title="æ”¯æŒå¤šç§æ•°æ®ç±»å‹"></a>æ”¯æŒå¤šç§æ•°æ®ç±»å‹</h4><p>åŸºäºSwiftçš„Stringçš„æ—¥å¿—è¾“å‡ºï¼ŒStringå¯ä»¥åŒ…å«æ’å…¥å€¼ï¼Œä¾‹å¦‚æ•´å½¢ï¼Œæµ®ç‚¹æ•°ï¼Œå¸ƒå°”ç±»å‹ï¼ŒObjective-Cå¯¹è±¡ï¼Œä»¥åŠä»»ä½•éµå¾ª<code>CustomStringConvertibleåè®®çš„ç±»å‹ï¼Œç”šè‡³åŒ…æ‹¬å…ƒç±»ï¼Œå¦‚Int.selfã€‚</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-keyword">let</span> logger = <span class="hljs-type">Logger</span>() <span class="hljs-keyword">let</span> x = <span class="hljs-number">42</span> logger.info(<span class="hljs-string">"The answer is \(x)"</span>)<br></code></pre></td></tr></table></figure><h4 id="ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼Œæ—¥å¿—ä¿ç•™åŠæ€§èƒ½"><a href="#ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼Œæ—¥å¿—ä¿ç•™åŠæ€§èƒ½" class="headerlink" title="ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼Œæ—¥å¿—ä¿ç•™åŠæ€§èƒ½"></a>ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼Œæ—¥å¿—ä¿ç•™åŠæ€§èƒ½</h4><p>æ—¥å¿—ä¿ç•™æ˜¯æŒ‡ä¸€æ¡æ—¥å¿—æ˜¯å¦å½’æ¡£ä»¥åŠèƒ½å¦åœ¨appæ‰§è¡Œç»“æŸè¢«å–å›ï¼Œç›¸åä¸è¢«ä¿ç•™çš„æ—¥å¿—ï¼Œåªèƒ½åœ¨appè¿è¡ŒæœŸé—´è¿›è¡Œæµå¼ä¼ è¾“ã€‚</p><p>èƒ½å¦è¢«ä¿ç•™æ˜¯ç”±æ—¥å¿—ç­‰çº§å†³å®šçš„ã€‚</p><table><thead><tr><th align="left">æ—¥å¿—ç­‰çº§</th><th align="left">æè¿°</th><th align="left">æ—¥å¿—ä¿ç•™</th></tr></thead><tbody><tr><td align="left">Debug</td><td align="left">åªç”¨åœ¨<strong>è°ƒè¯•</strong>æœŸé—´æœ‰ç”¨çš„ä¿¡æ¯ä¸Š</td><td align="left">ä¸ä¿ç•™</td></tr><tr><td align="left">Info</td><td align="left">ç”¨åœ¨æ•…éšœæ’æŸ¥æœ‰ç”¨ä½†ä¸æ˜¯å…³é”®ä¿¡æ¯ä¸Š</td><td align="left">æ—¥å¿—é‡‡é›†å‘½ä»¤ï¼ˆlog collectï¼‰ä¹‹å‰ç”Ÿæˆçš„æ¶ˆæ¯ä¼šè¢«ä¿ç•™</td></tr><tr><td align="left">Notice(default)</td><td align="left">å¯¹æ•…éšœæ’é™¤ç»å¯¹æœ‰ç”¨çš„ä¿¡æ¯ä¸Šï¼Œé»˜è®¤çš„æ—¥å¿—ç­‰çº§</td><td align="left">è¢«ä¿ç•™ï¼Œæœ‰å­˜å‚¨å®¹é‡ä¸Šé™è¶…è¿‡ä¸Šé™ï¼Œæ—§æ¶ˆæ¯ä¼šè¢«æ¸…é™¤</td></tr><tr><td align="left">Error</td><td align="left">è®°å½•è¿è¡ŒæœŸé—´çš„é”™è¯¯ä¿¡æ¯</td><td align="left">è¢«ä¿ç•™ï¼Œæœ‰å­˜å‚¨å®¹é‡ä¸Šé™è¶…è¿‡ä¸Šé™ï¼Œæ—§æ¶ˆæ¯ä¼šè¢«æ¸…é™¤</td></tr><tr><td align="left">Fault</td><td align="left">è®°å½•ç”±äºæ½œåœ¨ç¨‹åºé”™è¯¯è€Œå¼•å‘çš„æƒ…å†µ</td><td align="left">è¢«ä¿ç•™ï¼Œæœ‰å­˜å‚¨å®¹é‡ä¸Šé™è¶…è¿‡ä¸Šé™ï¼Œæ—§æ¶ˆæ¯ä¼šè¢«æ¸…é™¤</td></tr></tbody></table><p>Erorrå’ŒFaultçš„æ—¥å¿—ç­‰çº§ï¼Œåˆ†åˆ«ç”±é»„è‰²å’Œçº¢è‰²æ°”æ³¡çªå‡ºæ˜¾ç¤º</p><p><img src="https://i.loli.net/2021/04/07/3gvjFMp7OBnCZha.png" alt="WX20210331-211546@2x.png"></p><p>æ€§èƒ½ä¸æ—¥å¿—ç­‰çº§ç›¸å…³ï¼ŒDebugæ€§èƒ½æœ€å—ï¼ŒFaultæ€§èƒ½æ˜¯æœ€æ…¢ã€‚è¿™æ˜¯ç”±äºDebugæ—¥å¿—éƒ½ä¸ä¼šè¢«ä¿ç•™ï¼Œå¦‚æœæ—¥å¿—ä¸è¿›è¡Œæµå¼ä¼ è¾“å°±ä¼šè¢«åºŸå¼ƒã€‚</p><p>æ­¤å¤–swiftç¼–è¯‘å™¨å¯¹Debugæ—¥å¿—åšäº†å¤æ‚çš„ä¼˜åŒ–ã€‚è¿™å°±æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨Debugçº§åˆ«æ—¥å¿—è®°å½•è¯¦ç»†çš„ä¿¡æ¯ã€‚</p><h4 id="æ ¼å¼åŒ–"><a href="#æ ¼å¼åŒ–" class="headerlink" title="æ ¼å¼åŒ–"></a>æ ¼å¼åŒ–</h4><p>æ—¥å¿—åœ¨è¿è¡ŒæœŸé—´äº§ç”Ÿçš„åŸå§‹æ•°æ®ï¼Œå¾€å¾€éš¾ä»¥é˜…è¯»ã€‚Log API æä¾›äº†æ ¼å¼åŒ–åŠŸèƒ½æé«˜æ•°æ®çš„å¯è¯»æ€§ã€‚å¹¶ä¸”å¯ä»¥å°†æ ¼å¼åŒ–åçš„æ•°æ®æ‹·è´åˆ°Numbersé‡Œåšæ•°æ®åˆ†æ</p><h4 id="æ—¥å¿—éšç§"><a href="#æ—¥å¿—éšç§" class="headerlink" title="æ—¥å¿—éšç§"></a>æ—¥å¿—éšç§</h4><p>å½“åº”ç”¨ä¸‹è½½å®‰è£…åˆ°ç”¨æˆ·æ‰‹æœºä¸Šæ—¶ï¼Œæ—¥å¿—è®°å½•ä»ä¼šè¿›è¡Œã€‚åªè¦æŠŠæœ‰å®‰è£…è¯¥åº”ç”¨çš„è®¾å¤‡ä½¿ç”¨çº¿ç¼†è¿æ¥åˆ°ç”µè„‘ä¸Šï¼Œä»»ä½•äººéƒ½å¯ä»¥æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ï¼Œæ‰€ä»¥æœ‰å…³ä¸ªäººä¿¡æ¯çš„æ—¥å¿—ç»å¯¹ä¸èƒ½è¢«æ ‡è®°ä¸º <code>.public</code>ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs swift">logger.log(<span class="hljs-string">"Ordered smoothie \(smoothieName, privacy: .public)"</span>)  <span class="hljs-comment">// Visible </span><br>logger.log(<span class="hljs-string">"Paid with bank account \(accountNumber, privacy: .private(.hash))"</span>)  <span class="hljs-comment">// InVisible</span><br></code></pre></td></tr></table></figure><h3 id="APIå¯ç”¨æ€§"><a href="#APIå¯ç”¨æ€§" class="headerlink" title="APIå¯ç”¨æ€§"></a>APIå¯ç”¨æ€§</h3><p><img src="https://i.loli.net/2021/04/07/3P5Tah27QbJA1zF.png" alt="WX20210331-214452@2x.png"></p><p>ä¹‹å‰çš„ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ os_log è¿›è¡Œæ›¿ä»£ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://developer.apple.com/videos/play/wwdc2020/10168/" target="_blank" rel="noopener">https://developer.apple.com/videos/play/wwdc2020/10168/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Protocol Buffersä¸ºä»€ä¹ˆèƒ½æ›´å°ï¼Œæ›´å¿«</title>
      <link href="2020/05/23/Protocol-Buffers%E4%B8%BA%E4%BB%80%E4%B9%88%E8%83%BD%E6%9B%B4%E5%B0%8F%EF%BC%8C%E6%9B%B4%E5%BF%AB/"/>
      <url>2020/05/23/Protocol-Buffers%E4%B8%BA%E4%BB%80%E4%B9%88%E8%83%BD%E6%9B%B4%E5%B0%8F%EF%BC%8C%E6%9B%B4%E5%BF%AB/</url>
      
        <content type="html"><![CDATA[<p><code>Protobuf</code> æ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œå¯ç”¨äºé€šä¿¡åè®®æ•°æ®ä¼ è¾“ï¼Œæ•°æ®å­˜å‚¨ç­‰é¢†åŸŸã€‚</p><p>è¿™é‡Œè¯´é«˜æ•ˆä½“ç°åœ¨åºåˆ—åŒ–é€Ÿåº¦å—ï¼Œå ç”¨ç©ºé—´å°ï¼Œå¯¹æ•°æ®ç»“æ„æè¿°ç®€å•ä¸”èƒ½å¤ŸåµŒå¥— å¹¶ä¸”èƒ½å¤Ÿå‘åå…¼å®¹ã€‚</p><p>ä»Šå¤©æœ¬æ–‡ä¸»è¦æ˜¯æƒ³è®¨è®ºä¸ºä»€ä¹ˆèƒ½æ›´å°ï¼Œæ›´å¿«ã€‚å½“æˆ‘ä»¬è°ˆæ›´å°ï¼Œæ›´å¿«çš„æ—¶å€™ï¼Œéšå«äº†ä¸å…¶ä»–ä¸»æµåºåˆ—åŒ–æ–¹æ¡ˆçš„æ¯”è¾ƒï¼Œä¸»è¦æ˜¯<code>json</code>å’Œ<code>xml</code>ã€‚ä¼—æ‰€å‘¨çŸ¥<code>json</code>å’Œ<code>xml</code>æœ‰å¾ˆå¤šçš„åˆ†å‰²ç¬¦ï¼Œä¾‹å¦‚jsoné‡Œ { } [] : ç­‰ï¼Œ<code>Protobuf</code>åºåˆ—åŒ–æ˜¯æ²¡æœ‰è¿™äº›åˆ†å‰²ç¬¦çš„ï¼Œå…·ä½“ä¸‹é¢ä¼šè®²åˆ°ã€‚å¦ä¸€æ–¹<code>xml</code>è§£æéœ€è¦æ„å»ºæ–‡æ¡£ç»“æ„æ¨¡å‹ï¼Œè¿™é‡Œæ¶‰åŠåˆ°è¯æ³•åˆ†æï¼Œéœ€è¦å¾ˆå¤šçš„cpuè¿ç®—ã€‚<code>Protobuf</code>åºåˆ—åŒ–å¤§éƒ¨åˆ†éƒ½æ˜¯å¯¹äºŒè¿›åˆ¶æµè¿›è¡Œä½è¿ç®—ï¼Œç›¸å¯¹ä¼šé«˜æ•ˆå¾ˆå¤šã€‚è¿™é‡Œçš„æ›´å°ï¼Œæ›´å¿«æœ¬è´¨æ˜¯å–å†³äº<code>Protobuf</code>å¯¹encode/decodeå¤„ç†ã€‚</p><h2 id="æ¶ˆæ¯ç»“æ„"><a href="#æ¶ˆæ¯ç»“æ„" class="headerlink" title="æ¶ˆæ¯ç»“æ„"></a>æ¶ˆæ¯ç»“æ„</h2><p><code>Protobuf</code>  é‡‡ç”¨key-value pairsã€‚</p><p>Key ç”¨æ¥æ ‡è¯†å…·ä½“çš„ fieldï¼Œåœ¨è§£åŒ…çš„æ—¶å€™ï¼ŒProtocol Buffer æ ¹æ® Key å°±å¯ä»¥çŸ¥é“ç›¸åº”çš„ Value åº”è¯¥å¯¹åº”äºæ¶ˆæ¯ä¸­çš„å“ªä¸€ä¸ª fieldã€‚</p><p>keyçš„ç»“æ„å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">(field_number &lt;&lt; <span class="hljs-number">3</span>) | wire_type<br></code></pre></td></tr></table></figure><p>field_number æ˜¯æˆ‘ä»¬å®šä¹‰protoçš„field_id</p><p>wire_typeç±»å‹å¦‚ä¸‹</p><table><thead><tr><th align="left">Type</th><th align="left">Meaning</th><th align="left">Used For</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">Varint</td><td align="left">int32, int64, uint32, uint64, sint32, sint64, bool, enum</td></tr><tr><td align="left">1</td><td align="left">64-bit</td><td align="left">fixed64, sfixed64, double</td></tr><tr><td align="left">2</td><td align="left">Length-delimited</td><td align="left">string, bytes, embedded messages, packed repeated fields</td></tr><tr><td align="left">3</td><td align="left">Start group</td><td align="left">groups (deprecated)</td></tr><tr><td align="left">4</td><td align="left">End group</td><td align="left">groups (deprecated)</td></tr><tr><td align="left">5</td><td align="left">32-bit</td><td align="left">fixed32, sfixed32, float</td></tr></tbody></table><h2 id="Base-128-Varints"><a href="#Base-128-Varints" class="headerlink" title="Base 128 Varints"></a>Base 128 Varints</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¦ç†è§£ä»€ä¹ˆæ˜¯<code>Varints</code>ã€‚<code>Varints</code>æ˜¯ä¸€ç§ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚åºåˆ—åŒ–æ•´æ•°çš„æ–¹æ¡ˆï¼Œä¸€äº›å°çš„æ•°å­—ä½¿ç”¨æ›´å°‘çš„å­—èŠ‚ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªIntç±»å‹ä¸º4bytesï¼ˆä¸cpuå’Œç¼–è¯‘å™¨ç›¸å…³ï¼‰ï¼Œä»ç»Ÿè®¡çš„è§’åº¦çœ‹ï¼Œå°çš„æ•°å­—åº”ç”¨æ¦‚ç‡æ›´å¤šï¼Œæ‰€ä»¥4bytesä¼šæœ‰å¾ˆå¤šbitæ˜¯æµªè´¹æ‰ã€‚è¿™æ—¶å€™<code>Varints</code>èƒ½èµ·åˆ°å¾ˆå¥½ç©ºé—´åˆ©ç”¨ã€‚å½“ç„¶å¦‚æœæ˜¯å¤§æ•°ï¼Œå°±éœ€è¦å¤šä¸€ä¸ªå­—èŠ‚å­˜å‚¨æ ‡å¿—ä½äº†ã€‚</p><p>çœ‹æ ‡é¢˜128åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œ<code>Protobuf</code>ä½¿ç”¨8bitçš„æœ€é«˜ä½åšä½æ ‡å¿—ä½ï¼Œå³å¦‚æœè¯¥ä½ä¸º1ï¼Œè¡¨ç¤ºåç»­çš„å­—èŠ‚æ˜¯è¿™ä¸ªæ•°çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœæ˜¯0è¡¨ç¤ºæ•°å­—ç»“æŸã€‚æ‰€ä»¥ä¸€ä¸ªå­—èŠ‚æœ€å¤§èƒ½è¡¨ç¤º128äº†ï¼Œ</p><p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹ä¾‹å­ï¼Œæ­£æ•´æ•°300æ˜¯ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼š1010 1100 0000 0010</p><p>é¦–å…ˆæˆ‘ä»¬å»æ‰æ ‡å¿—ä½</p><p>010 1100 000 0010</p><p>Protobufé‡‡ç”¨å°ç«¯æ¨¡å¼å¤„ç†æ•°æ®ï¼Œéœ€è¦æ¢ä¸‹é¡ºåº</p><p>000 0010  010 1100</p><p>ç§»é™¤é«˜ä½0</p><p>1 0010 1100</p><p>æœ€åè®¡ç®—ç»“æœ</p><p>256 + 32 + 8 + 4 = 300</p><h2 id="æœ‰ç¬¦å·æ•´æ•°æ€ä¹ˆåŠ"><a href="#æœ‰ç¬¦å·æ•´æ•°æ€ä¹ˆåŠ" class="headerlink" title="æœ‰ç¬¦å·æ•´æ•°æ€ä¹ˆåŠ"></a>æœ‰ç¬¦å·æ•´æ•°æ€ä¹ˆåŠ</h2><p>æ ¹æ®ä¸Šé¢<code>Varints</code>çš„ç¼–ç ï¼Œé‚£è´Ÿæ•°æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæœ‰ç¬¦å·æ•´æ•°ä¹Ÿæ˜¯ç”¨å­—èŠ‚çš„æœ€é«˜ä½åšä½ç¬¦å·çš„æ ‡å¿—ä½ã€‚å³ç”¨ä¸€ä¸ªå¤§æ­£æ•´æ•°è¡¨ç¤ºè´Ÿæ•°ã€‚è¿™æ—¶å€™ç”¨<code>Varints</code>è¡¨ç¤ºè´Ÿæ•°å°±ä¸€å®šéœ€è¦5ä¸ªå­—èŠ‚ã€‚<code>Protobuf</code>å®šä¹‰äº†sint32 sint64å¹¶ä¸”é‡‡ç”¨<code>zigzag</code>ç¼–ç ã€‚ä½¿ç”¨<code>zigzag</code>ç¼–ç  ç»“åˆ <code>Varints</code> èƒ½ä¿è¯ç»å¯¹å€¼å°çš„æ•´æ•°ï¼Œé‡‡ç”¨è¾ƒå°‘çš„å­—èŠ‚æ¥åºåˆ—åŒ–ã€‚</p><p><code>zigzag</code>ç¼–ç å¤„ç†å¦‚ä¸‹</p><table><thead><tr><th align="left">Signed Original</th><th align="left">Encoded As</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">-1</td><td align="left">1</td></tr><tr><td align="left">1</td><td align="left">2</td></tr><tr><td align="left">-2</td><td align="left">3</td></tr><tr><td align="left">2147483647</td><td align="left">4294967294</td></tr><tr><td align="left">-2147483648</td><td align="left">4294967295</td></tr></tbody></table><p>å¯¹äºsint32</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">(n &lt;&lt; <span class="hljs-number">1</span>) ^ (n &gt;&gt; <span class="hljs-number">31</span>)<br></code></pre></td></tr></table></figure><p>å¯¹äºsint64</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">(n &lt;&lt; <span class="hljs-number">1</span>) ^ (n &gt;&gt; <span class="hljs-number">63</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¾ˆå¤šäººéƒ½ä¼šæƒ³åˆ°ï¼Œæ—¢ç„¶å­—èŠ‚çš„é«˜ä½å·²ç»è¢«å½“æˆ<code>Varints</code>çš„æ ‡å¿—ä½äº†ï¼Œé‚£æœ‰ç¬¦å·çš„æ ‡å¿—ä½èƒ½ä¸èƒ½æ”¾åœ¨æ¬¡é«˜ä½ã€‚è¿™æ ·åšæ˜¾ç„¶æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯è¿™æ ·ä¸èƒ½åšåˆ°å¦‚ä¸Šæ•ˆç‡æœ€å¤§åŒ–äº†ï¼Œè¿™æ ·åŸå…ˆçš„ä¸æ˜¯é‚£ä¹ˆå¤§çš„æ•°éƒ½è¦5ä¸ªå­—èŠ‚æ‰èƒ½è¡¨ç¤ºäº†ã€‚</p><h2 id="æ›´å¤šçš„ç±»å‹"><a href="#æ›´å¤šçš„ç±»å‹" class="headerlink" title="æ›´å¤šçš„ç±»å‹"></a>æ›´å¤šçš„ç±»å‹</h2><p><strong>éVarintç¼–ç æ•°å­—</strong></p><p>ä¾‹å¦‚double åŠ fixed64 æŒ‰åŸæ¥çš„æ–¹å¼ç¼–ç ï¼Œä¸è¿‡wire typeæ˜¯5</p><p><strong>å­—ç¬¦ä¸²</strong></p><p>å« å­—ç¬¦ä¸²é•¿åº¦ + å­—ç¬¦ä¸²ç¼–ç ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä½¿ç”¨<code>Varints</code>ç¼–ç </p><p><strong>åµŒå¥—æ¶ˆæ¯</strong></p><p>å¤„ç†æ–¹å¼ä¸å­—ç¬¦ä¸²ç±»ä¼¼</p><p><strong>å…¶ä»–</strong></p><p>å‚è€ƒä¸­æœ‰è¯´æ˜</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developers.google.com/protocol-buffers/docs/encoding" target="_blank" rel="noopener">https://developers.google.com/protocol-buffers/docs/encoding</a></p><p><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-gpb/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-cn-gpb/index.html</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HEIFå›¾ç‰‡æ ¼å¼å…¥é—¨</title>
      <link href="2020/04/24/HEIF%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E5%85%A5%E9%97%A8/"/>
      <url>2020/04/24/HEIF%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h3><p><a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E6%95%88%E7%8E%87%E5%9B%BE%E5%83%8F%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F" target="_blank" rel="noopener">HEIF</a> å…¨ç§° High Efficiency Image Format ï¼Œæ˜¯ä¸€ç§å­˜å‚¨å›¾ç‰‡å’Œå›¾ç‰‡åºåˆ—çš„æ ¼å¼ã€‚</p><p><a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E6%95%88%E7%8E%87%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">HEVC</a> å…¨ç§°High Efficiency Video Codingï¼Œæ˜¯ä¸€ç§è§†é¢‘ç¼–ç æ ¼å¼ã€‚</p><h4 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h4><p><img src="https://i.loli.net/2020/04/30/JLskQE954SV7DPi.jpg" alt="heif_container.jpg"></p><h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><p><strong>é«˜å‹ç¼©æ¯”</strong></p><p>ç›¸åŒç”»è´¨çš„æƒ…å†µä¸‹ï¼ŒHEIFå®¹é‡ä¸åˆ°JPGçš„ä¸€åŠ</p><p><strong>é«˜åˆ†è¾¨ç‡</strong></p><p>æ”¯æŒ48bitè‰²æ·±ï¼Œjpegæœ€å¤§24bit<a href="https://zh.wikipedia.org/wiki/%E8%89%B2%E5%BD%A9%E6%B7%B1%E5%BA%A6" target="_blank" rel="noopener">è‰²æ·±</a>ã€‚äººçœ¼èƒ½çœ‹è§æ•°ç™¾ä¸‡ä¸­é¢œè‰²</p><p><strong>é«˜æ‰©å±•æ€§</strong></p><p>HEIFæ˜¯ä¸€ç§å°è£…æ ¼å¼ï¼Œé™¤äº†ä¿å­˜ç¼©ç•¥å›¾ï¼Œæ‰©å±•ä¿¡æ¯ï¼ˆexifï¼‰ï¼ŒåŸå›¾æ•°æ®å¤–ï¼Œè¿˜èƒ½ä¿å­˜å…¶ä»–ä»»æ„ä¿¡æ¯ï¼Œä¾‹å¦‚å¤šå¼ å›¾ç‰‡ï¼ŒéŸ³é¢‘ç­‰ã€‚</p><h4 id="æ–‡ä»¶æ‰©å±•å"><a href="#æ–‡ä»¶æ‰©å±•å" class="headerlink" title="æ–‡ä»¶æ‰©å±•å"></a>æ–‡ä»¶æ‰©å±•å</h4><p>åç¼€åå¤§å°å†™ä¸æ•æ„Ÿ</p><table><thead><tr><th>Payload</th><th>Extension-single image</th><th>Extension-sequence</th></tr></thead><tbody><tr><td>HEVC</td><td>.HEIC</td><td>.HEICS</td></tr><tr><td>H.264</td><td>.AVCI</td><td>.AVCS</td></tr><tr><td>Any Codec</td><td>.HEIF</td><td>.HEIFS</td></tr></tbody></table><h3 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h3><h4 id="è‹¹æœç”Ÿæ€"><a href="#è‹¹æœç”Ÿæ€" class="headerlink" title="è‹¹æœç”Ÿæ€"></a>è‹¹æœç”Ÿæ€</h4><h5 id="æ”¯æŒçš„ç¡¬ä»¶"><a href="#æ”¯æŒçš„ç¡¬ä»¶" class="headerlink" title="æ”¯æŒçš„ç¡¬ä»¶"></a>æ”¯æŒçš„ç¡¬ä»¶</h5><p>è§£ç æ”¯æŒ</p><table><thead><tr><th></th><th>iOS</th><th>macOS</th></tr></thead><tbody><tr><td>Hardware Decode</td><td>A9 Chip</td><td>6th Generation Intel Core</td></tr><tr><td>Software Decode</td><td>All iOS Devices</td><td>All Macs</td></tr></tbody></table><p>ç¼–ç æ”¯æŒ</p><table><thead><tr><th></th><th>iOS</th></tr></thead><tbody><tr><td>Hardware</td><td>A10 Fusion Chip</td></tr></tbody></table><h5 id="æ”¯æŒçš„ç³»ç»Ÿ"><a href="#æ”¯æŒçš„ç³»ç»Ÿ" class="headerlink" title="æ”¯æŒçš„ç³»ç»Ÿ"></a>æ”¯æŒçš„ç³»ç»Ÿ</h5><p>iOS11åŠä»¥ä¸Š</p><p>MacOS 10.13åŠä»¥ä¸Š</p><h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h4><p>æ­è½½ Android 10 çš„è®¾å¤‡æ”¯æŒ HEIC å‹ç¼©å›¾ç‰‡æ ¼å¼</p><h4 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h4><p>å¼€æºçš„JavaScriptåº“</p><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p><a href="https://blogs.windows.com/windowsexperience/2018/03/16/announcing-windows-10-insider-preview-build-17123-for-fast/#UpPIwc3yVgJHc5Q8.97" target="_blank" rel="noopener">Windows 10 (Build 17123)</a></p><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><p>åˆ›å»º-æŸ¥çœ‹-è½¬ç </p><h4 id="ImageIO"><a href="#ImageIO" class="headerlink" title="ImageIO"></a>ImageIO</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-comment">// Read a heic image from file</span><br><span class="hljs-keyword">let</span> inputURL = <span class="hljs-type">URL</span>(fileURLWithPath: <span class="hljs-string">"/tmp/image.heic"</span>)<br><span class="hljs-keyword">let</span> source = <span class="hljs-type">CGImageSourceCreateWithURL</span>(inputURL <span class="hljs-keyword">as</span> <span class="hljs-type">CFURL</span>, <span class="hljs-literal">nil</span>)<br><span class="hljs-keyword">let</span> imageProperties = <span class="hljs-type">CGImageSourceCopyPropertiesAtIndex</span>(source, <span class="hljs-number">0</span>, <span class="hljs-literal">nil</span>) <span class="hljs-keyword">as</span>? [<span class="hljs-type">String</span>: <span class="hljs-type">Any</span>]<br><span class="hljs-keyword">let</span> image = <span class="hljs-type">CGImageSourceCreateImageAtIndex</span>(source, <span class="hljs-number">0</span>, <span class="hljs-literal">nil</span>)<br><span class="hljs-keyword">let</span> options = [kCGImageSourceCreateThumbnailFromImageIfAbsent <span class="hljs-keyword">as</span> <span class="hljs-type">String</span>: <span class="hljs-literal">true</span>, kCGImageSourceThumbnailMaxPixelSize <span class="hljs-keyword">as</span> <span class="hljs-type">String</span>: <span class="hljs-number">320</span>] <span class="hljs-keyword">as</span> [<span class="hljs-type">String</span>: <span class="hljs-type">Any</span>]<br><span class="hljs-keyword">let</span> thumb = <span class="hljs-type">CGImageSourceCreateThumbnailAtIndex</span>(source, <span class="hljs-number">0</span>, options <span class="hljs-keyword">as</span> <span class="hljs-type">CFDictionary</span>)<br></code></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-comment">// Writing a CGImage to a HEIC file</span><br><span class="hljs-keyword">let</span> url = <span class="hljs-type">URL</span>(fileURLWithPath: <span class="hljs-string">"/tmp/output.heic"</span>)<br><span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> destination = <span class="hljs-type">CGImageDestinationCreateWithURL</span>(url <span class="hljs-keyword">as</span> <span class="hljs-type">CFURL</span>,<br><span class="hljs-type">AVFileType</span>.heic <span class="hljs-keyword">as</span> <span class="hljs-type">CFString</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">nil</span>) <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"unable to create CGImageDestination"</span>)<br><span class="hljs-type">CGImageDestinationAddImage</span>(imageDestination, image, <span class="hljs-literal">nil</span>) <span class="hljs-type">CGImageDestinationFinalize</span>(imageDestination)<br></code></pre></td></tr></table></figure><h4 id="PhotoKit"><a href="#PhotoKit" class="headerlink" title="PhotoKit"></a>PhotoKit</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-comment">// Editing a HEIF photo -- save as JPEG</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">applyPhotoFilter</span><span class="hljs-params">(<span class="hljs-number">_</span> filterName: String, input: PHContentEditingInput, output: PHContentEditingOutput, completion: <span class="hljs-params">()</span></span></span> -&gt; ()) &#123;<br><span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> inputImage = <span class="hljs-type">CIImage</span>(contentsOf: input.fullSizeImageURL!) <span class="hljs-keyword">else</span> &#123; <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"can't load input image"</span>) &#125;<br><span class="hljs-keyword">let</span> outputImage = inputImage .applyingOrientation(input.fullSizeImageOrientation) .applyingFilter(filterName, withInputParameters: <span class="hljs-literal">nil</span>)<br><span class="hljs-comment">// Write the edited image as a JPEG.</span><br><span class="hljs-keyword">do</span> &#123; <span class="hljs-keyword">try</span> <span class="hljs-keyword">self</span>.ciContext.writeJPEGRepresentation(of: outputImage,<br>to: output.renderedContentURL, colorSpace: inputImage.colorSpace!, options: [:])<br>&#125; <span class="hljs-keyword">catch</span> <span class="hljs-keyword">let</span> error &#123; <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"can't apply filter to image: \(error)"</span>) &#125;<br>completion() &#125;<br></code></pre></td></tr></table></figure><h3 id="å›¾ç‰‡çŸ¥è¯†å¼•ç”³"><a href="#å›¾ç‰‡çŸ¥è¯†å¼•ç”³" class="headerlink" title="å›¾ç‰‡çŸ¥è¯†å¼•ç”³"></a>å›¾ç‰‡çŸ¥è¯†å¼•ç”³</h3><h4 id="ä½å›¾ä¸çŸ¢é‡å›¾"><a href="#ä½å›¾ä¸çŸ¢é‡å›¾" class="headerlink" title="ä½å›¾ä¸çŸ¢é‡å›¾"></a>ä½å›¾ä¸çŸ¢é‡å›¾</h4><p><strong>ä½å›¾ï¼ˆvector imageï¼‰</strong>ï¼šä½¿ç”¨åƒç´ ç‚¹é˜µåˆ—æ‹¼åˆçš„å›¾åƒ</p><p><strong>çŸ¢é‡å›¾ï¼ˆraster image ,bitmap imageï¼‰</strong>ï¼šé€šè¿‡æ•°å­¦å…¬å¼è®¡ç®—è·å¾—çš„å›¾å½¢å«çŸ¢é‡å›¾</p><h4 id="å…ƒæ•°æ®"><a href="#å…ƒæ•°æ®" class="headerlink" title="å…ƒæ•°æ®"></a>å…ƒæ•°æ®</h4><p>å­˜å‚¨æè¿°å›¾ç‰‡çš„å‚æ•°ï¼Œæ¯”å¦‚æ€§è´¨ï¼Œå†…å®¹ï¼Œæ ‡é¢˜ï¼Œåœ°ç†ä½ç½®ï¼Œç‰ˆæƒç­‰ï¼Œä¸ºæ–¹ä¾¿æ•°æ®åº“å’Œæ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ã€‚Exifï¼ˆExchangeable image file formatï¼‰æ˜¯è¢«å¹¿æ³›æ¥å—çš„æ ‡å‡†ã€‚</p><h4 id="å¸¸ç”¨å›¾ç‰‡æ ¼å¼"><a href="#å¸¸ç”¨å›¾ç‰‡æ ¼å¼" class="headerlink" title="å¸¸ç”¨å›¾ç‰‡æ ¼å¼"></a>å¸¸ç”¨å›¾ç‰‡æ ¼å¼</h4><p><strong>BMPï¼ˆBitmapï¼‰**</strong></p><p>windowsç³»ç»Ÿä¸‹çš„æ ‡å‡†ä½å›¾æ ¼å¼ï¼Œæ— å‹ç¼©</p><p><strong>GIFï¼ˆGraphics Interchange Formatï¼‰</strong></p><p>æ”¯æŒåŠ¨ç”»å›¾åƒï¼Œæ”¯æŒ256è‰²ï¼Œå¯¹çœŸå½©å›¾ç‰‡è¿›è¡Œæœ‰æŸå‹ç¼©</p><p><strong>PNGï¼ˆPortable Network Graphicsï¼‰</strong></p><p>æ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/æ— æŸå‹ç¼©" target="_blank" rel="noopener">æ— æŸå‹ç¼©</a>çš„<a href="https://zh.wikipedia.org/wiki/ä½å›¾" target="_blank" rel="noopener">ä½å›¾</a>å›¾å½¢æ ¼å¼ï¼Œæ”¯æŒç´¢å¼•ã€<a href="https://zh.wikipedia.org/wiki/ç°åº¦" target="_blank" rel="noopener">ç°åº¦</a>ã€<a href="https://zh.wikipedia.org/wiki/RGB" target="_blank" rel="noopener">RGB</a>ä¸‰ç§é¢œè‰²æ–¹æ¡ˆä»¥åŠ<a href="https://zh.wikipedia.org/wiki/Alphaé€šé“" target="_blank" rel="noopener">Alphaé€šé“</a>ç­‰ç‰¹æ€§ã€‚</p><p><strong>JPEGï¼ˆJoint Photographic Experts Group)</strong></p><p>æœ‰æŸå‹ç¼©ï¼Œèƒ½è¾¾åˆ°è¾ƒå¤§å‹ç¼©æ¯”</p><p><strong>JPEG 2000</strong></p><p><strong>TIFFï¼ˆTag Image File Formatï¼‰</strong></p><p>ç”¨äºä¼ ç»Ÿå½±åƒå°åˆ·ï¼Œå¯è¿›è¡Œæœ‰æŸæˆ–æ— æŸå‹ç¼©</p><p><strong>WEBP</strong></p><p>æ”¯æŒæœ‰æŸå‹ç¼©ã€æ— æŸå‹ç¼©ã€é€æ˜å’ŒåŠ¨ç”»</p><p><strong>HEIF</strong></p><p><strong>SVGï¼ˆScalable Vector Graphicsï¼‰</strong></p><p>åŸºäºXMLï¼Œç”±W3Cè”ç›Ÿè¿›è¡Œå¼€å‘çš„å¯ç¼©æ”¾çš„çŸ¢é‡å›¾ç‰‡</p><h4 id="å¸¸ç”¨æ ¼å¼æ¯”è¾ƒ"><a href="#å¸¸ç”¨æ ¼å¼æ¯”è¾ƒ" class="headerlink" title="å¸¸ç”¨æ ¼å¼æ¯”è¾ƒ"></a>å¸¸ç”¨æ ¼å¼æ¯”è¾ƒ</h4><p><img src="https://i.loli.net/2020/04/30/pWb2wZk3EvemSIL.jpg" alt="å¸¸ç”¨æ ¼å¼æ¯”è¾ƒ.jpg"></p><h4 id="é€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼"><a href="#é€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼" class="headerlink" title="é€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼"></a>é€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼</h4><p><img src="https://i.loli.net/2020/05/01/VA5fy6YLsIXWw8N.png" alt="å›¾ç‰‡æ ¼å¼é€‰æ‹©.png"></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://juejin.im/entry/5b2a244a6fb9a00e6a620cd6" target="_blank" rel="noopener">HEIF &amp; HEVC ä½ çŸ¥é“å¤šå°‘ï¼Ÿ</a></p><p><a href="https://developer.apple.com/videos/play/wwdc2017/503/" target="_blank" rel="noopener">Introducing HEIF and HEVC</a></p><p><a href="https://developer.apple.com/videos/play/wwdc2017/511/" target="_blank" rel="noopener">Working with HEIF and HEVC</a></p><p><a href="http://nokiatech.github.io/heif/#download" target="_blank" rel="noopener">High Efficiency Image File Format (HEIF)</a></p><p><a href="https://developer.apple.com/videos/play/wwdc2019/419" target="_blank" rel="noopener">Optimizing Storage in Your App</a></p><p><a href="https://support.apple.com/zh-cn/HT207022" target="_blank" rel="noopener">åœ¨ Apple è®¾å¤‡ä¸Šä½¿ç”¨ HEIF æˆ– HEVC åª’ä½“</a></p><p><a href="https://mp.weixin.qq.com/s/EUGLzI9aOui9CsXZHRusjA" target="_blank" rel="noopener">è¿™ä¸ªå›¾åƒæ ¼å¼æœªæ¥ä¼šç»Ÿæ²»ä½ çš„è®¾å¤‡</a></p><p><a href="https://source.android.com/devices/camera/heif" target="_blank" rel="noopener">HEIF å›¾ç‰‡å¤„ç†</a></p><p><a href="HEIF/heicå›¾ç‰‡æ–‡ä»¶è§£æ">HEIF/heicå›¾ç‰‡æ–‡ä»¶è§£æ</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>flutter pluginå¼€å‘</title>
      <link href="2019/03/08/flutter-plugin%E5%BC%80%E5%8F%91/"/>
      <url>2019/03/08/flutter-plugin%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h2 id="Packageåˆ†ç±»"><a href="#Packageåˆ†ç±»" class="headerlink" title="Packageåˆ†ç±»"></a><strong>Package</strong>åˆ†ç±»</h2><p><em>Dart packages</em></p><p><em>Plugin packages</em></p><h2 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">flutter create --org com.example --template=plugin hello <br><span class="hljs-meta">#</span><span class="bash">æˆ–è€…</span><br>flutter create --template=plugin -i swift -a kotlin hello<br></code></pre></td></tr></table></figure><h2 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h2><h3 id="platform-channels"><a href="#platform-channels" class="headerlink" title="platform channels"></a><a href="https://flutter.dev/docs/development/platform-integration/platform-channels" target="_blank" rel="noopener"><strong>platform channels</strong></a></h3><h4 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><p><img src="https://i.loli.net/2020/05/01/1dEvMn4WS2bVRXJ.png" alt="MethodChannelæ¶æ„.png"></p><h4 id="Channelåˆ†ç±»"><a href="#Channelåˆ†ç±»" class="headerlink" title="Channelåˆ†ç±»"></a><strong>Channel</strong>åˆ†ç±»</h4><p>BasicMessageChannel </p><p>MethodChannel </p><p>OptionalMethodChannel </p><p>EventChannel </p><p>å…·ä½“å‚è€ƒã€platform_channel.dart]</p><h4 id="MethodChannel"><a href="#MethodChannel" class="headerlink" title="MethodChannel"></a><strong>MethodChannel</strong></h4><p>name:unique<br> codec:ã€ StandardMessageCodec | JSONMessageCodec ã€‘ invokeMethod|invokeListMethod|invokeMapMethod:dart invoke native </p><p>MethodCallHandler: native call dart</p><h4 id="å‚æ•°æ”¯æŒçš„æ•°æ®ç±»å‹"><a href="#å‚æ•°æ”¯æŒçš„æ•°æ®ç±»å‹" class="headerlink" title="å‚æ•°æ”¯æŒçš„æ•°æ®ç±»å‹"></a>å‚æ•°æ”¯æŒçš„æ•°æ®ç±»å‹</h4><p><img src="https://i.loli.net/2020/05/01/LkqxphSRfldscAe.png" alt="flutter plugin å‚æ•°æ”¯æŒ.png"></p><h4 id="è°ƒâ½¤ç”¨ç»“æ„å›¾"><a href="#è°ƒâ½¤ç”¨ç»“æ„å›¾" class="headerlink" title="è°ƒâ½¤ç”¨ç»“æ„å›¾"></a>è°ƒâ½¤ç”¨ç»“æ„å›¾</h4><p><img src="http://assets.processon.com/chart_image/5c80b645e4b09a16b99944a1.png?_=1588294837162" alt=""></p><h4 id="Dependency"><a href="#Dependency" class="headerlink" title="Dependency"></a>Dependency</h4><p>pod </p><p>gradle</p><h2 id="æ·»åŠ æ–‡æ¡£"><a href="#æ·»åŠ æ–‡æ¡£" class="headerlink" title="æ·»åŠ æ–‡æ¡£"></a>æ·»åŠ æ–‡æ¡£</h2><p>é¡¹â½¬æ–‡æ¡£</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">README</span>.</span></span>md <br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CHANGELOG</span>.</span></span>md <br>LICENSE <br>APIâ½‚æ–‡æ¡£(dartdoc)<br></code></pre></td></tr></table></figure><p>ä¾‹å­<a href="https://pub.dartlang.org/packages/quick_actions%23-readme-tab-" target="_blank" rel="noopener">quick_actions 0.3.0+1</a> </p><h2 id="å‘å¸ƒPackage"><a href="#å‘å¸ƒPackage" class="headerlink" title="å‘å¸ƒPackage"></a>å‘å¸ƒPackage</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">flutter packages pub publish --dry-run <br><br>flutter packages pub publish<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://flutter.dev/docs/development/packages-and-plugins/developing-packages" target="_blank" rel="noopener">https://flutter.dev/docs/development/packages-and-plugins/developing-packages</a> </p><p><a href="https://flutter.dev/docs/development/platform-integration/platform-channels" target="_blank" rel="noopener">https://flutter.dev/docs/development/platform-integration/platform-channels</a> </p><p><a href="https://juejin.im/post/5b84ff6a6fb9a019f47d1cc9" target="_blank" rel="noopener">https://juejin.im/post/5b84ff6a6fb9a019f47d1cc9</a> </p><p><a href="https://medium.com/flutter-io/flutter-platform-channels-ce7f540a104e" target="_blank" rel="noopener">https://medium.com/flutter-io/flutter-platform-channels-ce7f540a104e</a> </p><p><a href="https://github.com/flutter/flutter/wiki/The-Engine-architecture" target="_blank" rel="noopener">https://github.com/flutter/flutter/wiki/The-Engine-architecture</a> </p><p><a href="https://juejin.im/post/5c3844fae51d4551ec60988e" target="_blank" rel="noopener">https://juejin.im/post/5c3844fae51d4551ec60988e</a> </p><p><a href="https://github.com/flutter/flutter/wiki" target="_blank" rel="noopener">https://github.com/flutter/flutter/wiki</a> <a href="https://cloud.tencent.com/developer/article/1366113" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1366113</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>djangoåº”ç”¨éƒ¨ç½²</title>
      <link href="2019/03/01/django%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/"/>
      <url>2019/03/01/django%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="Python-ç¯å¢ƒé…ç½®"><a href="#Python-ç¯å¢ƒé…ç½®" class="headerlink" title="Python ç¯å¢ƒé…ç½®"></a>Python ç¯å¢ƒé…ç½®</h2><p>æ¿€æ´»pythonè™šæ‹Ÿç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/venv/bin/activate<br></code></pre></td></tr></table></figure><p>é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">deactivate<br></code></pre></td></tr></table></figure><p>å¯¼å‡ºé¡¹ç›®ä¾èµ–åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip freeze &gt; requirments.txt<br></code></pre></td></tr></table></figure><p>å®‰è£…ä¾èµ–åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip3 install -r ~/rainbow/rainbow_server/requirments.txt<br></code></pre></td></tr></table></figure><p>é‡åˆ°Python.h: No such file or directory</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo yum install python-devel<br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹é¡¹ç›®é…ç½®"><a href="#ä¿®æ”¹é¡¹ç›®é…ç½®" class="headerlink" title="ä¿®æ”¹é¡¹ç›®é…ç½®"></a>ä¿®æ”¹é¡¹ç›®é…ç½®</h2><p>è®¾ç½®settings.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">DEBUG = <span class="hljs-literal">False</span><br>ALLOWED_HOSTS = [<span class="hljs-string">'å…¬ç½‘ip'</span>]<br></code></pre></td></tr></table></figure><p>é™æ€æ–‡ä»¶é…ç½®</p><p> setting.py æ–°å¢STATIC_ROOT</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">STATIC_ROOT=os.path.join(BASE_DIR,"static/")<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python manage.py collectstatic<br></code></pre></td></tr></table></figure><p>åˆ é™¤STATIC_ROOT</p><p>æ•°æ®åº“è¿ç§»</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">python manage.py makemigrations<br>python manage.py migrate<br></code></pre></td></tr></table></figure><p>é¡¹ç›®æµ‹è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python manage.py runserver 0.0.0.0:8000<br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯äº‘æœåŠ¡å™¨8000ç«¯å£é»˜è®¤æ˜¯ä¸å¼€æ”¾ï¼Œéœ€è¦ä¿®æ”¹ç½‘ç»œå®‰å…¨ç»„ï¼Œæµ‹è¯•å®Œæ¯•åéœ€è¦æ”¹å›å»ã€‚</p><h2 id="é…ç½®mysql"><a href="#é…ç½®mysql" class="headerlink" title="é…ç½®mysql"></a>é…ç½®mysql</h2><p>ä»¥ä¸‹ä»¥mysqlï¼Œè‹¥ä½¿ç”¨mariadb  æ›¿æ¢å³å¯</p><p>æŸ¥çœ‹æ˜¯å¦å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum list installed mysql*<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ˜¯å¦å®‰è£…è¿‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum list mysql*<br></code></pre></td></tr></table></figure><p>å®‰è£…mysqlå®¢æˆ·ç«¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install mysql<br></code></pre></td></tr></table></figure><p>å¯åŠ¨/å…³é—­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">service mysqld start<br>service mysqld stop<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹rootå¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -u root<br>use mysql;<br>update user set password&#x3D;password(&quot;123456&quot;) where user&#x3D;&quot;root&quot;;<br>flush privileges; <br>quit;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹é»˜è®¤å­—ç¬¦é›†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">vi</span> /etc/my.<span class="hljs-keyword">cnf</span><br></code></pre></td></tr></table></figure><p>[mysqld]è¿™è¡ŒğŸ‘†æ·»åŠ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[client]  <br>default-character-set=utf8<br></code></pre></td></tr></table></figure><p>[mysqld]è¿™è¡ŒğŸ‘‡æ·»åŠ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">default-storage-engine=INNODB  <br>character-set-server=utf8 <br>collation-server=utf8_general_ci<br></code></pre></td></tr></table></figure><p>åˆ›å»ºæ•°æ®åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create database æ•°æ®åº“å;<br></code></pre></td></tr></table></figure><p>é…ç½®è¿œç¨‹è¿æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39; WITH GRANT OPTION;<br>flush privileges;<br></code></pre></td></tr></table></figure><h2 id="é…ç½®uwsgi"><a href="#é…ç½®uwsgi" class="headerlink" title="é…ç½®uwsgi"></a>é…ç½®uwsgi</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip3 install uwsgi<br></code></pre></td></tr></table></figure><p>æ£€æµ‹æ˜¯æœ‰å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">uwsgi --http :8000 --module rainbow.wsgi<br></code></pre></td></tr></table></figure><p>å…¶ä»–æ­£å¼é…ç½®æ–‡ä»¶</p><p>uwsgi.ini</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[uwsgi]</span><br><span class="hljs-comment"># æŒ‡å®šIPç«¯å£ </span><br><span class="hljs-comment">#http11-socket  = 127.0.0.1:8000 #æµ‹è¯•ç”¨</span><br><span class="hljs-attr">socket</span>  = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8000</span><br><span class="hljs-comment"># é¡¹ç›®ç›®å½•</span><br><span class="hljs-attr">chdir</span> =  /root/rainbow/rainbow_server<br><span class="hljs-attr">wsgi-file</span> = rainbow_server/wsgi.py<br><span class="hljs-attr">processes</span> = <span class="hljs-number">4</span><br><span class="hljs-attr">threads</span> = <span class="hljs-number">2</span><br><span class="hljs-attr">stats</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9191</span><br><span class="hljs-comment">#socketæ“ä½œè®¾ç½®å†…éƒ¨è¶…æ—¶æ—¶é—´</span><br><span class="hljs-attr">socket-timeout</span> = <span class="hljs-number">60</span><br><span class="hljs-comment">#è¯·æ±‚è¶…æ—¶æ—¶é—´(&gt;=å®¢æˆ·ç«¯è®¾ç½®çš„è¶…æ—¶)</span><br><span class="hljs-attr">harakiri</span> = <span class="hljs-number">180</span><br><span class="hljs-comment">#è¯·æ±‚è¶…æ—¶æ—¥å¿—</span><br><span class="hljs-attr">harakiri-verbose</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment"># å¯åŠ¨uwsgiçš„ç”¨æˆ·åå’Œç”¨æˆ·ç»„</span><br><span class="hljs-attr">uid</span>=root<br><span class="hljs-attr">gid</span>=root<br><span class="hljs-comment">#é€€å‡ºã€é‡å¯æ—¶æ¸…ç†æ–‡ä»¶</span><br><span class="hljs-attr">vacuum</span> = <span class="hljs-literal">true</span>      <br><span class="hljs-comment">#æ—¥å¿—</span><br><span class="hljs-attr">daemonize</span> = /var/log/rainbow_uwsgi.log<br><span class="hljs-comment">#pidæ–‡ä»¶ï¼Œç”¨äºè„šæœ¬å¯åŠ¨ã€åœæ­¢uwsgi</span><br><span class="hljs-attr">pidfile</span> = /var/run/rainbow_test_uwsgi.pid<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å‚æ•°å¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">uwsgi --http 127.0.0.1:8000 --wsgi-file rainbow_server/uwsgi.py<br></code></pre></td></tr></table></figure><p>ä¸Šä¸€ä¸ªæœåŠ¡æœªå…³é—­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">ps -ef |grep uwsgi<br>kill -9 1234<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨iniæ–‡ä»¶å¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">uwsgi --ini uwsgi.ini [&amp;]<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨pidæ–‡ä»¶é‡å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">uwsgi --reload /var/run/rainbow_test_uwsgi.pid<br></code></pre></td></tr></table></figure><h2 id="é…ç½®ngnix"><a href="#é…ç½®ngnix" class="headerlink" title="é…ç½®ngnix"></a>é…ç½®ngnix</h2><p>å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install ngnix<br></code></pre></td></tr></table></figure><p>ç¼–è¾‘é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi rainbow_nginx.conf<br></code></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶å‘Šè¯‰nginxæä¾›æ¥è‡ªæ–‡ä»¶ç³»ç»Ÿçš„åª’ä½“å’Œé™æ€æ–‡ä»¶ï¼Œä»¥åŠå¤„ç†é‚£äº›éœ€è¦Djangoå¹²é¢„çš„è¯·æ±‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># the upstream component nginx needs to connect to</span><br><span class="hljs-attribute">upstream</span> django &#123;<br>    <span class="hljs-comment"># server unix:/root/rainbow/rainbow_test.sock; # for a file socket</span><br>    <span class="hljs-attribute">server</span> <span class="hljs-number">127.0.0.1:8000</span>; <span class="hljs-comment"># for a web port socket (we'll use this first)</span><br>&#125;<br> <br><span class="hljs-comment"># configuration of the server</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-comment"># the port your site will be served on</span><br>    <span class="hljs-attribute">listen</span>      <span class="hljs-number">80</span>;<br>    <span class="hljs-comment"># the domain name it will serve for</span><br>    <span class="hljs-attribute">server_name</span> test.rainbowplanet.club; <span class="hljs-comment"># substitute your machine's IP address or FQDN</span><br>    <span class="hljs-comment">#https support</span><br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>    <span class="hljs-attribute">ssl_certificate</span> /etc/nginx/ssl/rainbow_test.crt;<br>    <span class="hljs-attribute">ssl_certificate_key</span> /etc/nginx/ssl/rainbow_test.key;<br>    <span class="hljs-attribute">charset</span>     utf-<span class="hljs-number">8</span>;<br>    <br> <span class="hljs-attribute">server_tokens</span> <span class="hljs-literal">off</span>;<br>    <span class="hljs-comment"># max upload size</span><br>    <span class="hljs-attribute">client_max_body_size</span> <span class="hljs-number">75M</span>;   <span class="hljs-comment"># adjust to taste</span><br> <span class="hljs-comment">#log</span><br>    <span class="hljs-attribute">access_log</span>      /var/log/nginx/rainbow_test.access.log;<br>    <span class="hljs-attribute">error_log</span>       /var/log/nginx/rainbow_test.<span class="hljs-literal">error</span>.log;<br>    <span class="hljs-comment"># Django media</span><br>    <span class="hljs-attribute">location</span> /media  &#123;<br>        <span class="hljs-attribute">alias</span> /root/rainbow/rainbow_server/media;  <span class="hljs-comment"># your Django project's media files - amend as required</span><br>    &#125;<br> <br>    <span class="hljs-attribute">location</span> /static &#123;<br>        <span class="hljs-attribute">alias</span> /root/rainbow/rainbow_server/static; <span class="hljs-comment"># your Django project's static files - amend as required</span><br>    &#125;<br> <br>    <span class="hljs-comment"># Finally, send all non-media requests to the Django server.</span><br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">keepalive_timeout</span> <span class="hljs-number">60s</span>;<br>        <span class="hljs-attribute">client_body_timeout</span> <span class="hljs-number">20s</span>;<br>        <span class="hljs-attribute">uwsgi_send_timeout</span>   <span class="hljs-number">36s</span>;<br>        <span class="hljs-attribute">uwsgi_read_timeout</span>   <span class="hljs-number">36s</span>;<br>        <span class="hljs-attribute">uwsgi_connect_timeout</span> <span class="hljs-number">36s</span>;<br>        <span class="hljs-attribute">uwsgi_buffer_size</span>    <span class="hljs-number">512k</span>;<br>        <span class="hljs-attribute">uwsgi_buffers</span>     <span class="hljs-number">64</span> <span class="hljs-number">128k</span>;<br>        <span class="hljs-attribute">uwsgi_busy_buffers_size</span> <span class="hljs-number">1024k</span>;<br>        <span class="hljs-attribute">uwsgi_temp_file_write_size</span> <span class="hljs-number">512k</span>;<br>        <span class="hljs-attribute">uwsgi_pass</span>  django;<br>        <span class="hljs-attribute">include</span>   /root/rainbow/rainbow_server/uwsgi_params; <span class="hljs-comment"># the uwsgi_params file you installed</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å»ºç«‹è½¯è¿æ¥,è®©nginxçœ‹åˆ°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo ln -s /root/rainbow/rainbow_server/rainbow_nginx.conf /etc/nginx/conf.d/<br></code></pre></td></tr></table></figure><p>é‡å¯nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo service nginx restart<br>// nginx reload<br></code></pre></td></tr></table></figure><p>staticèµ„æº403é—®é¢˜</p><p>è§£å†³åŠæ³•1</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /etc/nginx/nginx.conf<br>user root;<br></code></pre></td></tr></table></figure><h2 id="é…ç½®redis"><a href="#é…ç½®redis" class="headerlink" title="é…ç½®redis"></a>é…ç½®redis</h2><p>ä¸‹è½½å¹¶å¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install redis<br>redis-server<br></code></pre></td></tr></table></figure><h2 id="é…ç½®https"><a href="#é…ç½®https" class="headerlink" title="é…ç½®https"></a>é…ç½®https</h2><p>åœ¨nginxç›®å½•ä¸‹åˆ›å»ºè¯ä¹¦</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo mkdir /etc/nginx/ssl/<br>sudo openssl req -x509 -nodes -days 36500 -newkey rsa:2048 -keyout /etc/nginx/ssl/rainbow_test.key -out /etc/nginx/ssl/rainbow_test.crt<br></code></pre></td></tr></table></figure><p>é…ç½®conf</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">listen 443 ssl;<br>ssl_certificate /etc/nginx/ssl/rainbow_test.crt;<br>ssl_certificate_key /etc/nginx/ssl/rainbow_test.key;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://uwsgi-docs-zh.readthedocs.io/zh_CN/latest/tutorials/Django_and_nginx.html" target="_blank" rel="noopener">https://uwsgi-docs-zh.readthedocs.io/zh_CN/latest/tutorials/Django_and_nginx.html</a></p><p><a href="https://www.cnblogs.com/dingjiaoyang/p/5110546.html" target="_blank" rel="noopener">https://www.cnblogs.com/dingjiaoyang/p/5110546.html</a></p><p><a href="https://cloud.tencent.com/developer/article/1156750" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1156750</a></p><p><a href="https://segmentfault.com/a/1190000004976222" target="_blank" rel="noopener">https://segmentfault.com/a/1190000004976222</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Aspectsæºç åˆ†æ-å¦‚ä½•å®ç°AOP</title>
      <link href="2019/01/14/Aspects%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0AOP/"/>
      <url>2019/01/14/Aspects%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0AOP/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« è°ˆæ˜¯AOPï¼Œé‚£ä»€ä¹ˆæ˜¯AOPå‘¢ï¼Œ<strong>é¢å‘åˆ‡é¢</strong>ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚é‚£ä¹ˆä»¥è¿™ä¸ªå®šä¹‰æ¥çœ‹ï¼ŒAspectsæ˜¯ä»¥Objective-Cè¯­è¨€åŠ¨æ€ç‰¹æ€§ï¼ˆruntimeï¼‰ï¼Œåœ¨è¿è¡ŒæœŸæ·»åŠ ç¨‹åºåŠŸèƒ½æ¥å®ç°çš„ã€‚</p><p>ä»Aspectsçš„ä½¿ç”¨æ–¹æ³•æ¥çœ‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">+ (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector<br>                      withOptions:(AspectOptions)options<br>                       usingBlock:(id)block<br>                            error:(NSError **)error;<br></code></pre></td></tr></table></figure><p>å®ƒå¯ä»¥å®ç°å¯¹æ–¹æ³•çš„åˆ‡é¢ï¼Œæ”¯æŒä¸‰ç§åˆ‡é¢æ–¹å¼ï¼Œä½¿ç”¨blockæ‰§è¡Œé¢å¤–åŠŸèƒ½ï¼Œä»¥åŠhookå¤±è´¥çš„è¿”å›ã€‚</p><p>è¿™æ—¶å€™æŠ›å‡ºä¸€ä¸ªé—®é¢˜å¦‚æœè®©ä½ æ¥è®¾è®¡ï¼Œä½ æ˜¯ä¸€ä¸ªæ€ä¹ˆæ ·çš„æ€è·¯ã€‚</p><p>æˆ‘æ˜¯è¿™æ ·è€ƒè™‘çš„ï¼Œé¦–å…ˆå¯¹æ–¹æ³•åˆ‡é¢çš„ç†è§£ï¼Œæ˜¾ç„¶æˆ‘å¯ä»¥åœ¨ç¨‹åºä»»ä½•åœ°æ–¹å¤šæ¬¡è¿›è¡Œçš„åˆ‡é¢ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬æ˜¯éœ€è¦æœ‰å¯¹åˆ‡é¢è¿›è¡Œæè¿°çš„å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠå¤šæ¬¡åˆ‡é¢è¿›è¡Œå­˜å‚¨ã€‚å…¶æ¬¡å¯¹äºblockå¦‚ä½•å®šä¹‰ï¼Œè¿™ä¸ªblockæ˜¯å®ç°selectoré¢å¤–çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆä»è¿™ä¸ªblockæˆ‘ä»¬èƒ½è·å–åˆ°å’Œselectorä¸€æ ·çš„ä¸Šä¸‹æ–‡ï¼Œå³å‚æ•°ï¼Œselfç­‰ã€‚æœ€åä¸€ä¸ªé—®é¢˜æ˜¯è°ƒç”¨selectorçš„åŒæ—¶ï¼Œå¦‚ä½•è°ƒèµ·ä½ çš„åˆ‡é¢ã€‚ç¬¬ä¸€ä¸ªä¼šæƒ³åˆ°å°±æ˜¯runtime  method-swizllingï¼Œé—®é¢˜ä¹Ÿæ˜¾è€Œæ˜“è§æˆ‘ä»¬éœ€è¦æ¯ä¸ªselectoréƒ½è¦å†™ä¸ªalias selector è¿›è¡Œæ›¿æ¢ï¼Œæ ¹æœ¬æ²¡Aspectsè¿™ä¹ˆé€šç”¨ã€‚ç¬¬äºŒä¸ªä¼šæƒ³åˆ°çš„å°±æ˜¯Objective-Cçš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼Œè®©è¢«hook selectorèµ°æ¶ˆæ¯è½¬å‘ï¼Œåœ¨forwardInvocationé‡Œæ’å…¥é¢å¤–çš„ä»£ç ã€‚å…¶å®Aspectså°±æ˜¯ä»¥ç¬¬äºŒç§æ–¹æ³•æ¥å®ç°çš„ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹å»å°±åˆ†æAspectså¦‚ä½•å®ç°åˆ‡é¢çš„ã€‚</p><p>å…ˆçœ‹ä¸‹Aspectsæ˜¯å¦‚ä½•å®šä¹‰å…³äºåˆ‡é¢çš„ä¿¡æ¯çš„</p><p>1ï¼Œåˆ‡é¢selectorä¿¡æ¯çš„å°è£…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">@interface AspectInfo : NSObject &lt;AspectInfo&gt;<br>- (id)initWithInstance:(__unsafe_unretained id)instance invocation:(NSInvocation *)invocation;<br>@property (nonatomic, unsafe_unretained, readonly) id instance;<br>@property (nonatomic, strong, readonly) NSArray *arguments;<br>@property (nonatomic, strong, readonly) NSInvocation *originalInvocation;<br>@end<br></code></pre></td></tr></table></figure><p>2ï¼Œåˆ‡é¢å¯¹è±¡</p><p>åŒ…å«åˆ‡é¢selectorï¼Œåˆ‡é¢blockï¼Œåˆ‡é¢ä½ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">@interface AspectIdentifier : NSObject<br>+ (instancetype)identifierWithSelector:(SEL)selector object:(id)object options:(AspectOptions)options block:(id)block error:(NSError **)error;<br>- (BOOL)invokeWithInfo:(id&lt;AspectInfo&gt;)info;<br>@property (nonatomic, assign) SEL selector;<br>@property (nonatomic, strong) id block;<br>@property (nonatomic, strong) NSMethodSignature *blockSignature;<br>@property (nonatomic, weak) id object;<br>@property (nonatomic, assign) AspectOptions options;<br>@end<br></code></pre></td></tr></table></figure><p>3ï¼Œåˆ‡é¢å®¹å™¨</p><p>åˆ‡é¢å®¹å™¨çš„ä½œç”¨æ˜¯å­˜å‚¨ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ä¸­çš„æ‰€æœ‰åˆ‡é¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">@interface AspectsContainer : NSObject<br>- (void)addAspect:(AspectIdentifier *)aspect withOptions:(AspectOptions)injectPosition;<br>- (BOOL)removeAspect:(id)aspect;<br>- (BOOL)hasAspects;<br>@property (atomic, copy) NSArray *beforeAspects;<br>@property (atomic, copy) NSArray *insteadAspects;<br>@property (atomic, copy) NSArray *afterAspects;<br>@end<br></code></pre></td></tr></table></figure><p>4ï¼Œåˆ‡é¢è·Ÿè¸ªå™¨</p><p>è¿™ä¸ªåˆ‡é¢è·Ÿè¸ªå™¨è®°å½•äº†ä¸€ä¸ªå¯¹è±¡ä¸­è¢«åˆ‡é¢æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶ä¸”è®°å½•å¯¹è±¡å±‚æ¬¡ç»“æ„ä¸­å…¶ä»–åˆ‡é¢è·Ÿè¸ªå™¨ã€‚å¯ä»¥æƒ³è±¡è¿™ä¸ªè¿½è¸ªå™¨è·Ÿå¯¹è±¡å±‚æ¬¡æ ‘ä¸€æ ·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">@interface AspectTracker : NSObject<br>- (id)initWithTrackedClass:(Class)trackedClass parent:(AspectTracker *)parent;<br>@property (nonatomic, strong) Class trackedClass;<br>@property (nonatomic, strong) NSMutableSet *selectorNames;<br>@property (nonatomic, weak) AspectTracker *parentEntry;<br>@end<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹å»çœ‹ä¸‹aspect_addæ–¹æ³•åˆ°åº•åšäº†ä»€ä¹ˆï¼Œ</p><p>1ï¼Œä½¿ç”¨aspect_performLockedä¿è¯ä»¥ä¸‹ä»£ç çº¿ç¨‹å®‰å…¨</p><p>2ï¼Œæ ¡éªŒselectorèƒ½å¦è¢«hook(å…·ä½“å“ªäº›selectorä¸èƒ½è¢«hookï¼Œå‚è€ƒæµç¨‹å›¾)</p><p>3ï¼Œè·å–åˆ‡é¢å®¹å™¨å¹¶å­˜å‚¨åˆ‡é¢å¯¹è±¡</p><p>4ï¼Œè·å–è¢«hookçš„classï¼ŒåŠ¨æ€ç”Ÿæˆå­ç±»å¹¶ä¸”hook  <code>forwardInovation</code>æ–¹æ³•ï¼Œè¿™æ ·ä¿è¯æ¶ˆæ¯è½¬å‘çš„æ—¶å€™ï¼Œèƒ½å¤Ÿæ‰§è¡Œé¢å¤–ä»£ç ã€‚è¿™é‡Œéœ€è¦classç›¸å…³çš„åŸºæœ¬çŸ¥è¯†ã€‚</p><p>5ï¼Œå¯¹hook selectoræ–°å¢alias selectorä¿å­˜åŸselectorä¿¡æ¯ï¼Œå°†hook selector çš„impå®ç°æ›¿æ¢æˆ<code>_objc_msgForward</code>/<code>_objc_msgForward_stret</code>  è¿™æ ·ä¿è¯äº†hook selectorèƒ½èµ°æ¶ˆæ¯è½¬å‘ã€‚</p><p>æµç¨‹å›¾å‚è€ƒï¼š</p><p><img src="http://assets.processon.com/chart_image/5c382dfee4b0f430adfe5e2a.png?_=1588239502392" alt="aspect_hook"></p><p>é‚£ä¹ˆæ¥ä¸‹å»åªéœ€è¦åœ¨forwardInvocationçš„hookæ–¹æ³•é‡Œæ‰§è¡Œåˆ‡é¢ä»£ç å³å¯ï¼Œ</p><p>1ï¼Œè·å–å¯¹åº”çš„åˆ‡é¢å®¹å™¨</p><p>2ï¼Œæ‰§è¡Œå„ä¸ªä½ç½®çš„åˆ‡é¢ï¼Œè‡³äºå¦‚ä½•æ‰§è¡Œblockï¼Œå¯ä»¥å‚è€ƒ<a href="https://mikefighting.github.io/2018/07/04/advance-block-use-in-aspects/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p><p>3ï¼Œå…¶ä»–å¼‚å¸¸å¤„ç†ï¼Œæ‰§è¡ŒåŸæ–¹æ³•æˆ–è€…æŠ›å‡º<code>doesNotRecognizeSelector</code>å¼‚å¸¸ã€‚</p><p>æœ€åçœ‹ä¸‹åˆ‡é¢çš„æ¸…ç†ï¼Œå…·ä½“çœ‹ä¸‹æµç¨‹å›¾</p><p><img src="http://assets.processon.com/chart_image/5c383ba7e4b0641c83d8136f.png?_=1588239529630" alt="aspect_remove"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°BeeHiveå¦‚ä½•å®ç°Annotation</title>
      <link href="2019/01/08/%E8%AE%B0BeeHive%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0Annotation/"/>
      <url>2019/01/08/%E8%AE%B0BeeHive%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0Annotation/</url>
      
        <content type="html"><![CDATA[<p>çœ‹å¦‚ä¸‹çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @BeeHiveMod å®ç° DJHanFuModule åŠ¨æ€æ·»åŠ åˆ°beehiveçš„æ¨¡å—ç®¡ç†å™¨ä¸­ã€‚</p><p>å¦‚æœä¸æ˜¯ç”¨æ³¨è§£ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶DJModules.plistè¿›è¡Œé…ç½®æˆ–è€…åœ¨åº”ç”¨å¯åŠ¨çš„æŸä¸ªåœ°æ–¹ç«Ÿå¯èƒ½æ—©çš„è°ƒç”¨registerDynamicModuleæ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">@BeeHiveMod(DJHanFuModule) <br>@interface DJHanFuModule : NSObject <br>@end<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬ä¼šæœ‰ç–‘é—® @BeeHiveMod æ˜¯å¦‚ä½•å°† DJHanFuModule æ·»åŠ åˆ°beehiveçš„æ¨¡å—ç®¡ç†å™¨ä¸­ï¼Œå¹¶ä¸”èƒ½å¤Ÿé‚£ä¹ˆæ—©çš„æ·»åŠ è¿›å»ã€‚</p><p>é€šè¿‡é˜…è¯»æºç ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„å®èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">#define BeeHiveDATA(sectname) __attribute((used, section(&quot;__DATA,&quot;#sectname&quot; &quot;)))  <br>#define BeeHiveMod(name) \ class BeeHive; char * k##name##_mod BeeHiveDATA(BeehiveMods) &#x3D; &quot;&quot;#name&quot;&quot;; <br>#define BeeHiveService(servicename,impl) \ class BeeHive; char * k##servicename##_service BeeHiveDATA(BeehiveServices) &#x3D; &quot;&#123; \&quot;&quot;#servicename&quot;\&quot; : \&quot;&quot;#impl&quot;\&quot;&#125;&quot;;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬çš„å…³æ³¨ç‚¹åœ¨__attribute,è¿™ä¸ªä»£ç æ˜¯ä»€ä¹ˆç”¨çš„ï¼Œå¹¶ä¸”åé¢ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœä½ çŸ¥é“mach-oæ–‡ä»¶æ ¼å¼ï¼Œä½ åº”è¯¥ä¼šæœ‰æ„Ÿè§‰ã€‚</p><p>é‚£ä»€ä¹ˆæ˜¯__attributeï¼š</p><p><strong><code>__attribute__</code>æ˜¯åœ¨C, C++, Objective-Cè¯­è¨€ä¸­ä½¿ç”¨çš„ç¼–è¯‘æŒ‡ä»¤ï¼Œä¸€èˆ¬ä»¥<code>__attribute__(xxx)</code>çš„å½¢å¼å‡ºç°åœ¨ä»£ç ä¸­ï¼Œæ–¹ä¾¿å¼€å‘è€…å‘ç¼–è¯‘å™¨è¡¨è¾¾æŸç§è¦æ±‚ï¼Œå‚ä¸æ§åˆ¶å¦‚Static Analyzerã€Name Manglingã€Code Generationç­‰è¿‡ç¨‹ã€‚</strong></p><p>_attributeè¿™ä¸ªä»£ç ä¸­å‚æ•°</p><p>ç¬¬ä¸€ä¸ªå‚æ•°<strong>usedï¼š</strong></p><p>è¿™ä¸ªå‚æ•°æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæˆ‘ä»¬å®šä¹‰çš„å‡½æ•°æˆ–è€…å˜é‡ï¼Œå³ä½¿æ²¡æœ‰è¢«å¼•ç”¨åˆ°ï¼Œè¯·ç¼–è¯‘å™¨é«˜æŠ¬è´µæ‰‹ä¸è¦ä¼˜åŒ–æ‰å®ƒï¼Œå³åˆ é™¤æ‰ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°<strong>section</strong>ï¼š</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šå°†å˜é‡å­˜å‚¨åœ¨mach-oæ–‡ä»¶çš„<strong>DATAæŸäº›æ®µé‡Œï¼Œsectionèƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨</strong>DATAå¼€è¾Ÿæ–°çš„æ•°æ®æ®µï¼Œæ¥å­˜å‚¨ä¸€äº›ç‰¹æ®Šçš„å˜é‡ã€‚</p><p>å¾ˆæ˜¾ç„¶BeeHiveMod å’Œ  BeeHiveService ä¸¤ä¸ªå®å®ç°çš„åŠŸèƒ½å³æŠŠç”¨æ³¨è§£æ³¨é‡Šè¿‡çš„module å’Œ service å­˜å‚¨èµ·æ¥ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œbeehiveæ˜¯æ€ä¹ˆè¯»å– ä»¥åŠ ä»€ä¹ˆæ—¶å€™è¯»å–å‘¢ã€‚</p><p>çœ‹å¦‚ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">__attribute__((constructor)) <br>void initProphet() <br>&#123;     <br>  _dyld_register_func_for_add_image(dyld_callback); <br>&#125;<br>&#x2F;&#x2F;__attribute__ å¯ä»¥å®ç°constructorï¼Œè€Œconstructoræ˜¯åœ¨class loadå®Œä¹‹åï¼Œmainå‡½æ•°è°ƒç”¨ä¹‹å‰ï¼Œdyldä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚<br></code></pre></td></tr></table></figure><p>å†çœ‹ä¸‹_dyld_register_func_for_add_image è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥åœ¨dyld åŠ è½½å®Œimageåè°ƒç”¨dyld_callbackå›è°ƒï¼Œ</p><p>è¿™ä¸ªå›è°ƒå‡½æ•°å®šä¹‰å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">static void dyld_callback(const struct mach_header *mhp, intptr_t vmaddr_slide)<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è·å–åˆ°mach_headerï¼Œç„¶åé€šè¿‡getsectiondataå°±å¯ä»¥è½»æ¾åœ°è·å–åˆ°ä¹‹å‰é€šè¿‡æ³¨è§£å­˜å‚¨çš„module å’Œ serviceäº†ã€‚</p><p>è¿™æ—¶å€™æ³¨è§£æ³¨é‡Šè¿‡module å’Œ service è·å–åˆ°äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°æŠŠmoduleæ·»åŠ åˆ°beehiveæ¨¡å—ç®¡ç†å™¨ä¸­äº†ã€‚</p><p>åæ¥æˆ‘æƒ³äº†æƒ³æ˜¯å¦å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å®ç°åŒæ ·çš„åŠŸèƒ½ã€‚</p><p>æˆ‘æƒ³åˆ°çš„æ˜¯å°†æ³¨è§£çš„module å’Œ service å­˜å‚¨åˆ°å…¨å±€æ•°ç»„å˜é‡é‡Œï¼Œç„¶ååœ¨AppDelegate  didFinishLaunchingWithOptions æ–¹æ³•ä¸­è§£æã€‚è¿™ç§æ–¹æ³•ä¸ä¸Šè¿°å…¶å®æ˜¯ç±»ä¼¼çš„ï¼Œå…¨å±€å˜é‡æ˜¯å­˜å‚¨åœ¨mach-æ–‡ä»¶dataæ®µé‡Œã€‚ä¸è¿‡è‡ªå·±ä¸éœ€è¦å®ç°sectionçš„è¯»å–ã€‚</p><p>æœ€åä½¿ç”¨__attributeå®ç°anotationï¼Œä¹Ÿæ˜¯æ¯”è¾ƒå·§å¦™çš„ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼åœ¨iOSä¸­çš„åº”ç”¨</title>
      <link href="2018/09/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9C%A8iOS%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
      <url>2018/09/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9C%A8iOS%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼</h1><p>è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚ æ¯«æ— ç–‘é—®ï¼Œè®¾è®¡æ¨¡å¼äºå·±äºä»–äººäºç³»ç»Ÿéƒ½æ˜¯å¤šèµ¢çš„ï¼Œè®¾è®¡æ¨¡å¼ä½¿ä»£ç ç¼–åˆ¶çœŸæ­£å·¥ç¨‹åŒ–ï¼Œè®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹çš„åŸºçŸ³ï¼Œå¦‚åŒå¤§å¦çš„ä¸€å—å—ç –çŸ³ä¸€æ ·ã€‚é¡¹ç›®ä¸­åˆç†çš„è¿ç”¨è®¾è®¡æ¨¡å¼å¯ä»¥å®Œç¾çš„è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œæ¯ç§æ¨¡å¼åœ¨ç°åœ¨ä¸­éƒ½æœ‰ç›¸åº”çš„åŸç†æ¥ä¸ä¹‹å¯¹åº”ï¼Œæ¯ä¸€ä¸ªæ¨¡å¼æè¿°äº†ä¸€ä¸ªåœ¨æˆ‘ä»¬å‘¨å›´ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œè¿™ä¹Ÿæ˜¯å®ƒèƒ½è¢«å¹¿æ³›åº”ç”¨çš„åŸå› ã€‚ç®€å•è¯´ï¼š</p><p><strong>æ¨¡å¼ï¼šåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œé’ˆå¯¹æŸç±»é—®é¢˜çš„æŸç§é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</strong></p><p>åœºæ™¯ï¼šé¡¹ç›®æ‰€åœ¨çš„ç¯å¢ƒ</p><p>é—®é¢˜ï¼šçº¦æŸæ¡ä»¶ï¼Œé¡¹ç›®ç›®æ ‡ç­‰</p><p>è§£å†³æ–¹æ¡ˆï¼šé€šç”¨ã€å¯å¤ç”¨çš„è®¾è®¡ï¼Œè§£å†³çº¦æŸè¾¾åˆ°ç›®æ ‡ã€‚</p><h1 id="è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>è®¾è®¡æ¨¡å¼åˆ†ç±»</h1><p>åˆ›å»ºå‹æ¨¡å¼ï¼šå¯¹è±¡å®ä¾‹åŒ–çš„æ¨¡å¼ï¼Œåˆ›å»ºå‹æ¨¡å¼ç”¨äºè§£è€¦å¯¹è±¡çš„å®ä¾‹åŒ–è¿‡ç¨‹ã€‚</p><p>ç»“æ„å‹æ¨¡å¼ï¼šæŠŠç±»æˆ–å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ›´å¤§çš„ç»“æ„ã€‚</p><p>è¡Œä¸ºå‹æ¨¡å¼ï¼šç±»å’Œå¯¹è±¡å¦‚ä½•äº¤äº’ï¼ŒåŠåˆ’åˆ†è´£ä»»å’Œç®—æ³•ã€‚</p><h1 id="iOS-å…·ä½“åº”ç”¨"><a href="#iOS-å…·ä½“åº”ç”¨" class="headerlink" title="iOS å…·ä½“åº”ç”¨"></a>iOS å…·ä½“åº”ç”¨</h1><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">+ (MotionOrientation *)sharedInstance &#123;     <span class="hljs-keyword">static</span> MotionOrientation *sharedInstance = <span class="hljs-literal">nil</span>;     <span class="hljs-keyword">static</span> <span class="hljs-built_in">dispatch_once_t</span> onceToken;     <span class="hljs-built_in">dispatch_once</span>(&amp;onceToken, ^&#123;         sharedInstance = [[MotionOrientation alloc] init];     &#125;);     <span class="hljs-keyword">return</span> sharedInstance; &#125;<br></code></pre></td></tr></table></figure><h3 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h3><p>å®šä¹‰ï¼šå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚ </p><p>æè¿°ï¼šæœ¬è´¨ä¸Šæ˜¯è§¦å‘è”åŠ¨ </p><p>ä¾‹å­ï¼šnotification/kvo</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">[[NSNotificationCenter defaultCenter] <span class="hljs-string">addObserver:</span>self                                              <span class="hljs-string">selector:</span><span class="hljs-meta">@selector</span>(<span class="hljs-string">onAppWillResignActive:</span>)                                                  <span class="hljs-string">name:</span>UIApplicationWillResignActiveNotification                                                <span class="hljs-string">object:</span>nil];<br></code></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">[_currentItem <span class="hljs-string">addObserver:</span>self <span class="hljs-string">forKeyPath:</span>@<span class="hljs-string">"status"</span> <span class="hljs-string">options:</span>NSKeyValueObservingOptionNew <span class="hljs-string">context:</span>nil];<br></code></pre></td></tr></table></figure><h3 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h3><p>å®šä¹‰ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚ </p><p>æè¿°ï¼šå°è£…è¯·æ±‚ </p><p>ä¾‹å­ï¼štarget-action </p><h3 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h3><p>å®šä¹‰ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ </p><p>æè¿°ï¼šä»£ç†æ¨¡å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œç”¨è¿™ä¸ªä»£ç†å¯¹è±¡å»ä»£è¡¨çœŸå®çš„å¯¹è±¡ </p><p>ä¾‹å­ï¼šä½¿ç”¨NSProxyæ¨¡æ‹Ÿå¤šç»§æ‰¿ï¼Œdelegate</p><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><p>å®šä¹‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡å®ä¾‹çš„åŠŸèƒ½ï¼Œè€Œæ— é¡»å…³å¿ƒå…¶å…·ä½“å®ç°ã€‚è¢«åˆ›å»ºå®ä¾‹çš„ç±»å‹å¯ä»¥æ˜¯æ¥å£ã€æŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“çš„ç±» </p><p>æè¿°ï¼šç®€å•å·¥å‚ï¼Œé™æ€å·¥å‚ï¼Œä¸‡èƒ½å·¥å‚ </p><p>ä¾‹å­ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">DJHomeRecommendBaseCell *cell = &#123;             [self.collectionView <span class="hljs-string">dequeueReusableCellWithReuseIdentifier:</span>key <span class="hljs-string">forIndexPath:</span>indexPath]         &#125;;<br></code></pre></td></tr></table></figure><h3 id="è£…é¥°æ¨¡å¼"><a href="#è£…é¥°æ¨¡å¼" class="headerlink" title="è£…é¥°æ¨¡å¼"></a>è£…é¥°æ¨¡å¼</h3><p>å®šä¹‰ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´» </p><p>æè¿°ï¼šæœ¬è´¨ä¸Šæ˜¯åŠ¨æ€ç»„åˆ </p><p>ä¾‹å­ï¼šcategory/method swizzling/delegation </p><h3 id="å¤–è§‚æ¨¡å¼"><a href="#å¤–è§‚æ¨¡å¼" class="headerlink" title="å¤–è§‚æ¨¡å¼"></a>å¤–è§‚æ¨¡å¼</h3><p>å®šä¹‰ï¼šä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒFacadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚ </p><p>æè¿°ï¼šå¤–è§‚æ¨¡å¼é€šè¿‡å¼•å…¥å¤–è§‚ç±»ï¼Œåœ¨ç±»é‡Œå®šä¹‰ç®€å•çš„æ–¹æ³•ï¼Œç„¶ååœ¨å®ç°çš„æ–¹æ³•é‡Œï¼Œå†è°ƒç”¨å¤šä¸ªæ¨¡å—çš„åŠŸèƒ½ã€‚ </p><p>ä¾‹å­ï¼šè®¿é—®æ¥å£è¿”å›çš„æ•°æ®å¯èƒ½ä»æœåŠ¡ç«¯ï¼Œç¼“å­˜ï¼Œæ•°æ®åº“ç­‰è·å– </p><h3 id="å¤‡å¿˜å½•æ¨¡å¼"><a href="#å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼"></a>å¤‡å¿˜å½•æ¨¡å¼</h3><p>å®šä¹‰ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚</p><p>æè¿°ï¼šæ‰€è°“å¤‡å¿˜å½•æ¨¡å¼å°±æ˜¯åœ¨ä¸ç ´åå°è£…çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»¥åå°†å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p><p>ä¾‹å­ï¼šArchiving/Serialization/<a href="https://www.raywenderlich.com/117471/state-restoration-tutorial" target="_blank" rel="noopener"><strong>State Restoration</strong></a></p><h3 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h3><p>å®šä¹‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨æ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ </p><p>æè¿°ï¼šç›®çš„æ˜¯å¤ç”¨å·²æœ‰çš„åŠŸèƒ½ </p><p>ä¾‹å­ï¼šProtocol</p><h3 id="æ¨¡æ¿æ¨¡å¼"><a href="#æ¨¡æ¿æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ¨¡å¼"></a>æ¨¡æ¿æ¨¡å¼</h3><p>å®šä¹‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p><p>æè¿°ï¼šä¸€äº›æ–¹æ³•é€šç”¨ï¼Œå´åœ¨æ¯ä¸€ä¸ªå­ç±»éƒ½é‡æ–°å†™äº†è¿™ä¸€æ–¹æ³•ã€‚å°†è¿™äº›é€šç”¨ç®—æ³•æŠ½è±¡å‡ºæ¥</p><p>ä¾‹å­ï¼šDJBaseCollectionViewCell</p><h3 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h3><p>å®šä¹‰ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p><p>æè¿°ï¼šå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤§é‡çš„å…³è”å…³ç³»ï¼Œè¿™æ ·åŠ¿å¿…ä¼šå¯¼è‡´ç³»ç»Ÿçš„ç»“æ„å˜å¾—å¾ˆå¤æ‚ï¼ŒåŒæ—¶è‹¥ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è·Ÿè¸ªä¸ä¹‹ç›¸å…³è”çš„å¯¹è±¡ï¼ŒåŒæ—¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚</p><p>ä¾‹å­ï¼šRouter</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WebSocketåè®®åŠåœ¨ä¸œå®¶ä¸­çš„åº”ç”¨</title>
      <link href="2018/08/31/WebSocket%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
      <url>2018/08/31/WebSocket%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="WebSocketèƒŒæ™¯"><a href="#WebSocketèƒŒæ™¯" class="headerlink" title="WebSocketèƒŒæ™¯"></a><a href="https://zh.wikipedia.org/zh-hans/WebSocket" target="_blank" rel="noopener">WebSocket</a>èƒŒæ™¯</h2><p>æ—©æœŸï¼Œç½‘ç«™ä¸ºäº†å®ç°<a href="https://zh.wikipedia.org/wiki/æ¨é€æŠ€æœ¯" target="_blank" rel="noopener">æ¨é€æŠ€æœ¯</a>ï¼Œåªèƒ½é€šè¿‡<a href="https://zh.wikipedia.org/wiki/è¼ªè©¢" target="_blank" rel="noopener">è½®è¯¢</a>è¿™ç§æ–¹å¼ã€‚è½®è¯¢æ˜¯æŒ‡æµè§ˆå™¨æ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚æ¯ç§’ï¼‰å‘æœåŠ¡å™¨å‘å‡ºHTTPè¯·æ±‚ï¼Œä¹‹åæœåŠ¡å™¨è¿”å›æœ€æ–°çš„æ•°æ®ç»™æµè§ˆå™¨ã€‚è½®è¯¢è¿™ç§æ–¹å¼æœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼Œå³æµè§ˆå™¨éœ€è¦ä¸æ–­çš„å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œç„¶è€ŒHTTPè¯·æ±‚ä¸å“åº”å¯èƒ½ä¼šåŒ…å«è¾ƒé•¿çš„<a href="https://zh.wikipedia.org/wiki/HTTPå¤´å­—æ®µ" target="_blank" rel="noopener">å¤´éƒ¨</a>ï¼Œå…¶ä¸­çœŸæ­£æœ‰æ•ˆçš„æ•°æ®å¯èƒ½åªæ˜¯å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·ä¼šæ¶ˆè€—å¾ˆå¤šå¸¦å®½èµ„æºã€‚</p><p>æ¯”è¾ƒæ–°çš„è½®è¯¢æŠ€æœ¯æ˜¯<a href="https://zh.wikipedia.org/wiki/Comet_(webæŠ€æœ¯)" target="_blank" rel="noopener">Comet</a>ã€‚è¿™ç§æŠ€æœ¯è™½ç„¶å¯ä»¥å®ç°åŒå‘é€šä¿¡ï¼Œä½†ä»ç„¶éœ€è¦åå¤å‘å‡ºè¯·æ±‚ã€‚è€Œä¸”åœ¨Cometä¸­æ™®éé‡‡ç”¨çš„<a href="https://zh.wikipedia.org/wiki/HTTPæŒä¹…é“¾æ¥" target="_blank" rel="noopener">HTTPé•¿è¿æ¥</a>ä¹Ÿä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<a href="https://zh.wikipedia.org/wiki/HTML5" target="_blank" rel="noopener">HTML5</a>å®šä¹‰äº†WebSocketåè®®ï¼Œèƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å®æ—¶åœ°è¿›è¡Œé€šè®¯ã€‚</p><h2 id="WebSocketåè®®"><a href="#WebSocketåè®®" class="headerlink" title="WebSocketåè®®"></a>WebSocketåè®®</h2><p>WebSocketä½¿ç”¨<code>ws</code>æˆ–<code>wss</code>çš„<a href="https://zh.wikipedia.org/wiki/ç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦" target="_blank" rel="noopener">ç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦</a>ï¼ˆURIï¼‰ã€‚<code>wss</code>è¡¨ç¤ºä½¿ç”¨äº†<a href="https://zh.wikipedia.org/wiki/TLS" target="_blank" rel="noopener">TLS</a>çš„WebSocketã€‚å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">ws://example.com/wsapi<br>wss://secure.example.com/wsapi<br></code></pre></td></tr></table></figure><p>WebSocketä¸HTTPå’ŒHTTPSä½¿ç”¨ç›¸åŒçš„TCP<a href="https://zh.wikipedia.org/wiki/TCP/UDPç«¯å£åˆ—è¡¨" target="_blank" rel="noopener">ç«¯å£</a>ï¼Œå¯ä»¥ç»•è¿‡å¤§å¤šæ•°<a href="https://zh.wikipedia.org/wiki/é˜²ç«å¢™" target="_blank" rel="noopener">é˜²ç«å¢™</a>çš„é™åˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebsocketåè®®ä½¿ç”¨80ç«¯å£ï¼›è¿è¡Œåœ¨TLSä¹‹ä¸Šæ—¶ï¼Œé»˜è®¤ä½¿ç”¨443ç«¯å£ã€‚</p><h3 id="æ¡æ‰‹åè®®"><a href="#æ¡æ‰‹åè®®" class="headerlink" title="æ¡æ‰‹åè®®"></a>æ¡æ‰‹åè®®</h3><p>WebSocket æ˜¯ç‹¬ç«‹çš„ã€å»ºç«‹åœ¨ TCP ä¸Šçš„åè®®ã€‚</p><p>Websocket é€šè¿‡ <a href="https://zh.wikipedia.org/wiki/HTTP" target="_blank" rel="noopener">HTTP</a>/1.1 åè®®çš„101<a href="https://zh.wikipedia.org/wiki/HTTPçŠ¶æ€ç " target="_blank" rel="noopener">çŠ¶æ€ç </a>è¿›è¡Œæ¡æ‰‹ã€‚</p><p>ä¾‹å­ï¼š</p><p><img src="https://i.loli.net/2020/04/30/1Xt3rWTNapvKqxo.png" alt="websocketæ•°æ®å¸§.png"></p><p>ä¾‹å­ä½¿ç”¨<a href="https://github.com/joewalnes/websocketd" target="_blank" rel="noopener">websocketd</a>å¸¦çš„demoæŠ“å–çš„è¯·æ±‚å’Œå“åº”ã€‚</p><h3 id="æ•°æ®å¸§æ ¼å¼"><a href="#æ•°æ®å¸§æ ¼å¼" class="headerlink" title="æ•°æ®å¸§æ ¼å¼"></a>æ•°æ®å¸§æ ¼å¼</h3><p><img src="https://i.loli.net/2020/04/30/f6MHnU7uDaJwkig.png" alt="websokcetæ¡æ‰‹.png"></p><p><strong>å…·ä½“å­—æ®µå«ä¹‰å‚è€ƒæ–‡æœ«<a href="https://www.cnblogs.com/chyingp/p/websocket-deep-in.html" target="_blank" rel="noopener">è¿æ¥</a></strong>è¿™é‡Œä¸åšè¿‡å¤šç¼€è¿°ã€‚</p><h2 id="WebSocketåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨"><a href="#WebSocketåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨" class="headerlink" title="WebSocketåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨"></a>WebSocketåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨</h2><p>ä¸œå®¶appåœ¨WebSocketä¸Šåšäº†ä¸°å¯Œçš„åœºæ™¯è½åœ°ï¼Œç›´æ’­åŠæ‹å–çš„èŠå¤©å®¤åº”ç”¨ï¼Œç§ä¿¡ï¼ˆimï¼‰åº”ç”¨ï¼Œå…¨å±€é•¿é“¾æ¥ç­‰ã€‚iOSé‡‡ç”¨<a href="https://github.com/facebook/SocketRocket" target="_blank" rel="noopener">SRWebSocket</a>ï¼ŒAndroidé‡‡ç”¨okhttpè‡ªå¸¦WebSocket</p><h3 id="æ¡æ‰‹è¯·æ±‚å¤´"><a href="#æ¡æ‰‹è¯·æ±‚å¤´" class="headerlink" title="æ¡æ‰‹è¯·æ±‚å¤´"></a>æ¡æ‰‹è¯·æ±‚å¤´</h3><p>è¿™é‡Œä¸åº”ç”¨httpæ¡†æ¶çš„è¯·æ±‚å¤´ä¿æŒä¸€è‡´å³å¯</p><h3 id="åºåˆ—åŒ–æ–¹æ¡ˆ"><a href="#åºåˆ—åŒ–æ–¹æ¡ˆ" class="headerlink" title="åºåˆ—åŒ–æ–¹æ¡ˆ"></a>åºåˆ—åŒ–æ–¹æ¡ˆ</h3><p>æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯<a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener">Protocol Buffers</a>ï¼Œæ˜¯å› ä¸ºç›¸æ¯”äºå…¶ä»–çš„åºåˆ—åŒ–æ–¹æ¡ˆå¦‚jsonï¼Œxmlã€‚protobufæ›´å¿«ï¼Œæ›´å°ï¼Œæ›´ç®€å•ã€‚å…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡åšæ–‡ã€Š<a href="https://www.ibm.com/developerworks/cn/linux/l-cn-gpb/index.html" target="_blank" rel="noopener">Google Protocol Buffer çš„ä½¿ç”¨å’ŒåŸç†</a>ã€‹</p><p>å½“ç„¶åœ¨ä½¿ç”¨protocol buffers ä¸­ä¹Ÿä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œ</p><ol><li>ä¸€ä¸ªæšä¸¾å®šä¹‰çš„ç±»å‹ï¼ŒåæœŸæ–°å¢ç±»å‹å€¼ï¼Œè€ç‰ˆæœ¬ä¸èƒ½å…¼å®¹ã€‚å¦‚æœè€ç‰ˆæœ¬è§£ææœªåšå¼‚å¸¸å¤„ç†ï¼Œä¼šå¯¼è‡´crashã€‚</li><li>æ³¨æ„ç¼–è¯‘çš„ç‰ˆæœ¬ï¼Œå‰åç«¯ä½¿ç”¨protobufç¼–è¯‘çš„ç‰ˆæœ¬è¦ç»Ÿä¸€ï¼Œå¦åˆ™ä¹Ÿæ˜¯æ— æ³•è§£æçš„ã€‚ç›®å‰æˆ‘ä»¬æ˜¯é€šè¿‡Jenkinsç¼–è¯‘ä¸åŒè¯­è¨€pbæ–‡ä»¶ï¼Œä¸éœ€è¦æ‹¿æºæ–‡ä»¶è‡ªå·±ç¼–è¯‘ã€‚æ‰€ä»¥å¯ä»¥å¾ˆå¥½çš„è§„é¿è¿™ä¸ªç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li></ol><h3 id="åº”ç”¨å±‚å¿ƒè·³"><a href="#åº”ç”¨å±‚å¿ƒè·³" class="headerlink" title="åº”ç”¨å±‚å¿ƒè·³"></a>åº”ç”¨å±‚å¿ƒè·³</h3><p>å¿ƒè·³ç”¨äºæ£€æµ‹ä¸æœåŠ¡ç«¯çš„è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œå½±å“è¿æ¥ä¸»è¦ä»¥ä¸‹å› ç´ ã€‚</p><ul><li>ç½‘ç»œçŠ¶æ€å˜åŒ–â€“æ‰‹æœºç½‘ç»œå’ŒWIFIç½‘ç»œåˆ‡æ¢ã€ç½‘ç»œæ–­å¼€å’Œè¿ä¸Šç­‰æƒ…å†µæœ‰ç½‘ç»œçŠ¶æ€çš„å˜åŒ–ï¼Œä¹Ÿä¼šä½¿é•¿è¿æ¥å˜ä¸ºæ— æ•ˆè¿æ¥</li><li>NATè¶…æ—¶â€“å¤§éƒ¨åˆ†ç§»åŠ¨æ— çº¿ç½‘ç»œè¿è¥å•†åœ¨é“¾è·¯ä¸€æ®µæ—¶é—´æ²¡æœ‰æ•°æ®é€šè®¯æ—¶ï¼Œä¼šæ·˜æ±° NATè¡¨ä¸­çš„å¯¹åº”é¡¹ï¼Œé€ æˆé“¾è·¯ä¸­æ–­ã€‚ç†æƒ³çš„æƒ…å†µä¸‹,å®¢æˆ·ç«¯åº”å½“ä»¥ç•¥å°äºNATè¶…æ—¶æ—¶é—´çš„é—´éš”æ¥å‘é€å¿ƒè·³åŒ…</li><li>DHCPç§ŸæœŸâ€“DHCPç§ŸæœŸåˆ°äº†éœ€è¦ä¸»åŠ¨ç»­çº¦ï¼Œå¦åˆ™ä¼šç»§ç»­ä½¿ç”¨è¿‡æœŸIPå¯¼è‡´é•¿è¿æ¥å¶ç„¶çš„æ–­è¿ï¼›</li></ul><p>ä»WebSocketæ•°æ®å¸§ä¸­æœ‰pingï¼Œpongä¸¤ç§æ“ä½œç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒå®ç°å¿ƒè·³ã€‚æ— éœ€é€šè¿‡å…¶ä»–æ“ä½œç è‡ªå®šä¹‰å¿ƒè·³ã€‚</p><p>å¯ä»¥é‡‡ç”¨å®šæ—¶å‘é€å¿ƒè·³åŒ…ï¼Œæ£€æµ‹è¿æ¥çš„æœ‰æ•ˆæ€§ã€‚</p><p>å½“ç„¶è¿™é‡Œè¿˜å¯ä»¥è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œä½¿ç”¨æ™ºèƒ½å¿ƒè·³ç­–ç•¥ã€‚å³å¿ƒè·³æ—¶é—´ä¸æ˜¯å›ºå®šçš„ï¼Œå¦‚æœæœ‰å“åº”æ¶ˆæ¯å¯ä»¥æ¨è¿Ÿå¿ƒè·³ã€‚</p><h3 id="é‡è¿æœºåˆ¶"><a href="#é‡è¿æœºåˆ¶" class="headerlink" title="é‡è¿æœºåˆ¶"></a>é‡è¿æœºåˆ¶</h3><p>é€šè¿‡åº”ç”¨å±‚å¿ƒè·³æˆ‘ä»¬å¯ä»¥æ£€æµ‹åˆ°è¿æ¥çš„æœ‰æ•ˆæ€§ï¼Œå½“æˆ‘ä»¬å¤±å»è¿æ¥çš„æ—¶å€™ã€‚å®¢æˆ·ç«¯éœ€è¦å‘èµ·é‡è¿æœºåˆ¶ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦è€ƒè™‘ç»™åˆ°ä¸šåŠ¡å±‚åé¦ˆã€‚</p><h3 id="åœºæ™¯å¤„ç†"><a href="#åœºæ™¯å¤„ç†" class="headerlink" title="åœºæ™¯å¤„ç†"></a>åœºæ™¯å¤„ç†</h3><h4 id="åº”ç”¨å‰åå°åˆ‡æ¢"><a href="#åº”ç”¨å‰åå°åˆ‡æ¢" class="headerlink" title="åº”ç”¨å‰åå°åˆ‡æ¢"></a>åº”ç”¨å‰åå°åˆ‡æ¢</h4><p>iOSåº”ç”¨åˆ‡æ¢åˆ°åå°ï¼Œå¦‚æœåº”ç”¨æœªå¼€å¯åå°å¸¸é©»èƒ½åŠ›ã€‚é•¿é“¾æ¥è‹¥å¹²åˆ†é’Ÿåä¼šè¢«æ–­å¼€ã€‚ä¹‹ååº”ç”¨åˆ‡æ¢åˆ°å‰å°è¦è€ƒè™‘ç«‹å³é‡æ–°è¿æ¥ä¸Šã€‚</p><h4 id="ç½‘ç»œçŠ¶æ€å˜åŒ–"><a href="#ç½‘ç»œçŠ¶æ€å˜åŒ–" class="headerlink" title="ç½‘ç»œçŠ¶æ€å˜åŒ–"></a>ç½‘ç»œçŠ¶æ€å˜åŒ–</h4><p>å¦‚æœæˆ‘ä»¬æ£€æµ‹åˆ°å½“å‰ç½‘ç»œä¸å¯ç”¨ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘å–æ¶ˆæ‰å¿ƒè·³æœºåˆ¶å’Œé‡è¿æœºåˆ¶ï¼Œç­‰åˆ°ç½‘ç»œæ¢å¤åå†æ¢å¤è¿æ¥ã€‚è¿™æ ·å¯ä»¥å‡å°‘cpuèµ„æºçš„æµªè´¹ã€‚</p><h4 id="ç”¨æˆ·ç™»å½•çŠ¶æ€å˜åŒ–"><a href="#ç”¨æˆ·ç™»å½•çŠ¶æ€å˜åŒ–" class="headerlink" title="ç”¨æˆ·ç™»å½•çŠ¶æ€å˜åŒ–"></a>ç”¨æˆ·ç™»å½•çŠ¶æ€å˜åŒ–</h4><p>è¿™é‡Œè€ƒè™‘å¦‚æœå½“å‰é•¿è¿æ¥ä¸ç”¨æˆ·çŠ¶æ€ç›¸å…³ï¼Œå½“ç”¨æˆ·ç™»å½•çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ˜¯éœ€è¦é‡è¿ æˆ–è€… æ–­å¼€è¿æ¥ã€‚</p><h4 id="è¯·æ±‚ç¼“å­˜ç­–ç•¥"><a href="#è¯·æ±‚ç¼“å­˜ç­–ç•¥" class="headerlink" title="è¯·æ±‚ç¼“å­˜ç­–ç•¥"></a>è¯·æ±‚ç¼“å­˜ç­–ç•¥</h4><p>æœ‰ä¸šåŠ¡åœºæ™¯éœ€è¦å¯ä»¥åŠ ä¸Šï¼Œå½“è¿æ¥æ–­å¼€äº†ï¼Œæ¥è‡ªä¸šåŠ¡æ–¹ä¸€äº›è¯·æ±‚å¦‚æœä¸åšç¼“å­˜ï¼Œè¿™æ—¶å€™ç›´æ¥ä¸¢å¼ƒäº†ã€‚å¦‚æœæœ‰ç¼“å­˜ï¼Œèƒ½ä¿è¯æˆåŠŸåç¬¬ä¸€æ—¶é—´å‘é€å‡ºå»ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://tools.ietf.org/html/rfc6455" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc6455</a></p><p><a href="https://zh.wikipedia.org/zh-hans/WebSocket" target="_blank" rel="noopener">https://zh.wikipedia.org/zh-hans/WebSocket</a></p><p><a href="https://www.cnblogs.com/chyingp/p/websocket-deep-in.html" target="_blank" rel="noopener">https://www.cnblogs.com/chyingp/p/websocket-deep-in.html</a></p><p><a href="https://www.xncoding.com/2017/05/03/web/websocket.html" target="_blank" rel="noopener">https://www.xncoding.com/2017/05/03/web/websocket.html</a></p><p><a href="https://caofengbin.github.io/2018/03/16/dhcp-and-nat/" target="_blank" rel="noopener">https://caofengbin.github.io/2018/03/16/dhcp-and-nat/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Xcodeç¼–è¯‘æ—¶é—´ä¼˜åŒ–</title>
      <link href="2018/05/09/Xcode%E7%BC%96%E8%AF%91%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/"/>
      <url>2018/05/09/Xcode%E7%BC%96%E8%AF%91%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="Xcode-Build-Setting-Optimization-Level"><a href="#Xcode-Build-Setting-Optimization-Level" class="headerlink" title="Xcode Build Setting  Optimization Level"></a>Xcode Build Setting  Optimization Level</h2><p>å…³äº<a href="https://developer.apple.com/library/content/documentation/General/Conceptual/MOSXAppProgrammingGuide/Performance/Performance.html" target="_blank" rel="noopener">Optimization Level</a> é…ç½®é€‰é¡¹çš„å«ä¹‰ç‚¹å‡»æ ‡é¢˜é“¾æ¥æŸ¥çœ‹ã€‚æŒ‰ç…§æ–‡æ¡£æè¿°é…ç½®ä½¿ç”¨Fastestï¼Œç¼–è¯‘ä»£ç é€Ÿåº¦ä¼šæ˜¯æœ€å¿«çš„ï¼Œç„¶è€Œæµ‹è¯•æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿä¸æ¨èæ­¤é€‰é¡¹ã€‚</p><p>å¯¹äºPodå·¥ç¨‹æ¯ä¸ªtargetå¦‚ä½•è®¾ç½®å¦‚ä¸‹ï¼Œç›®å‰Podç‰ˆæœ¬é»˜è®¤è®¾ç½®çš„Levelæ˜¯None</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br>post_install <span class="hljs-keyword">do</span> <span class="hljs-params">|installer|</span><br><br>installer.pods_project.build_configurations.each <span class="hljs-keyword">do</span> <span class="hljs-params">|config|</span><br><br><span class="hljs-keyword">if</span> config.name.<span class="hljs-keyword">include</span>?(<span class="hljs-string">"Debug"</span>)<br><br> config.build_settings[<span class="hljs-string">'GCC_OPTIMIZATION_LEVEL'</span>] = â€˜<span class="hljs-number">0</span><span class="hljs-string">'</span><br><span class="hljs-string"></span><br><span class="hljs-string">end</span><br><span class="hljs-string"></span><br><span class="hljs-string">end</span><br><span class="hljs-string"></span><br><span class="hljs-string">end</span><br></code></pre></td></tr></table></figure><h2 id="Xcodeç¼–è¯‘çº¿ç¨‹æ•°è®¾ç½®"><a href="#Xcodeç¼–è¯‘çº¿ç¨‹æ•°è®¾ç½®" class="headerlink" title="Xcodeç¼–è¯‘çº¿ç¨‹æ•°è®¾ç½®"></a>Xcodeç¼–è¯‘çº¿ç¨‹æ•°è®¾ç½®</h2><p>çº¿ç¨‹æ•°ä¸CPUçš„å‹å·æœ‰å…³ï¼Œç›®å‰Xcodeé»˜è®¤è®¾ç½®çº¿ç¨‹æ•°æ˜¯4ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>defaults write xcodebuild PBXNumberOfParallelBuildSubtasks 8 <br><br>defaults write xcodebuild IDEBuildOperationMaxNumberOfConcurrentCompileTasks 8 <br><br>defaults write com.apple.xcode PBXNumberOfParallelBuildSubtasks 8 defaults write com.apple.xcode IDEBuildOperationMaxNumberOfConcurrentCompileTasks 8<br></code></pre></td></tr></table></figure><h2 id="Build-Active-Architecture-Only"><a href="#Build-Active-Architecture-Only" class="headerlink" title="Build Active Architecture Only"></a>Build Active Architecture Only</h2><p>è®¾ç½®ç¼–è¯‘æ¶æ„çš„ç‰ˆæœ¬,å¦‚æœè®¾ç½®YESçš„è¯åªç¼–è¯‘å½“å‰æ´»è·ƒçš„æ¶æ„ï¼ŒNOåˆ™ä¸ºå…¨éƒ¨æ¶æ„ï¼ˆarmv7,armv7s,arm64)ã€‚</p><p>å¯¹äºPodå·¥ç¨‹å¦‚ä¸‹é…ç½®</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br>post_install <span class="hljs-keyword">do</span> <span class="hljs-params">|installer|</span><br><br> installer.pods_project.targets.each <span class="hljs-keyword">do</span> <span class="hljs-params">|target|</span><br><br> target.build_configurations.each <span class="hljs-keyword">do</span> <span class="hljs-params">|config|</span><br><br>      <span class="hljs-keyword">if</span> config.name == <span class="hljs-string">'Debug'</span><br><br>          config.build_settings[<span class="hljs-string">'ONLY_ACTIVE_ARCH'</span>] = <span class="hljs-string">'YES'</span><br><br>        <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><h2 id="Debug-Information-Format"><a href="#Debug-Information-Format" class="headerlink" title="Debug Information Format"></a>Debug Information Format</h2><p><a href="https://developer.apple.com/legacy/library/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html#//apple_ref/doc/uid/TP40003931-CH3-SW52" target="_blank" rel="noopener">Debug Information Format</a> æœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œå¯é€‰æ‹©å¦‚ä¸‹ä¸¤ç§</p><ul><li><a href="https://en.wikipedia.org/wiki/DWARF" target="_blank" rel="noopener">DWARF</a>(æ ‡å‡†åŒ–è°ƒè¯•æ•°æ®æ ¼å¼)</li></ul><ul><li>DWARF with dSYM File</li></ul><p>ä¸€èˆ¬Debugä½¿ç”¨ç¬¬ä¸€ç§ï¼ŒReleaseç”¨ç¬¬äºŒç§ã€‚</p><h2 id="äºŒè¿›åˆ¶åŒ–"><a href="#äºŒè¿›åˆ¶åŒ–" class="headerlink" title="äºŒè¿›åˆ¶åŒ–"></a>äºŒè¿›åˆ¶åŒ–</h2><p>äºŒè¿›åˆ¶åŒ–æ˜¯æŒ‡æˆ‘ä»¬çš„ç¬¬ä¸‰æ–¹ä¾èµ–ä¸ä½¿ç”¨æºç è¿™ç§å½¢å¼ï¼Œè€Œæ˜¯ä½¿ç”¨å·²ç¼–è¯‘å¥½çš„é™æ€é“¾æ¥åº“(.a)/åŠ¨æ€é“¾æ¥åº“ï¼ˆframework)ã€‚</p><p>ç›®å‰iOSå¼€å‘ä¾èµ–ç®¡ç†åŸºæœ¬ä½¿ç”¨<a href="https://github.com/CocoaPods/CocoaPods" target="_blank" rel="noopener"><em>CocoaPods</em></a>ï¼Œå®ƒæ˜¯åŸºäºæºç ç®¡ç†çš„ã€‚</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://github.com/Carthage/Carthage" target="_blank" rel="noopener"><em>Carthage</em></a>ï¼Œå®ƒæ˜¯åŸºäºäºŒè¿›åˆ¶æ¥ç®¡ç†çš„ã€‚</p><p>ç›®å‰CocoaPodsä¹Ÿæ˜¯å¯ä»¥é…ç½®äºŒè¿›åˆ¶åŒ–<strong>cocoapods-packager</strong>ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°<a href="https://www.zybuluo.com/qidiandasheng/note/595740" target="_blank" rel="noopener">PodäºŒè¿›åˆ¶åŒ–</a></p><p>å…¶ä»–å·¥å…·ä¾‹å¦‚ï¼š<a href="https://buckbuild.com" target="_blank" rel="noopener">Buck</a>ï¼Œ<a href="https://bazel.build" target="_blank" rel="noopener">Bazel</a></p><h2 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h2><ul><li>frameworkå¤´æ–‡ä»¶å¯¼å…¥å¤šä½¿ç”¨ @importï¼Œå°‘ç”¨#import ã€‚ä½¿ç”¨@importæ•ˆç‡æ›´å¥½ï¼Œå®‰å…¨æ€§æ›´å¥½ã€‚</li></ul><ul><li>å¤´æ–‡ä»¶ä¸­å¤šç”¨@class(é¢„å£°æ˜å®šä¹‰)ï¼Œå°‘ç”¨#import </li></ul><ul><li>åˆ é™¤æ— ç”¨ä»£ç åŠèµ„æº</li></ul><h2 id="ccahe"><a href="#ccahe" class="headerlink" title="ccahe"></a>ccahe</h2><p><a href="https://ccache.samba.org" target="_blank" rel="noopener">ccahe</a>æ˜¯ç¼–è¯‘å™¨ç¼“å­˜ï¼ŒXcodeè‡ªå¸¦çš„ç¼–è¯‘ç¼“å­˜åœ¨å¾ˆå¤šæƒ…å†µä¸‹å›å¤±æ•ˆï¼Œå¯¼è‡´ç¼–è¯‘æ—¶é—´æœ‰æ—¶å€™ä¼šå¾ˆé•¿ã€‚</p><h2 id="ç¡¬ä»¶åŠ é€Ÿ"><a href="#ç¡¬ä»¶åŠ é€Ÿ" class="headerlink" title="ç¡¬ä»¶åŠ é€Ÿ"></a>ç¡¬ä»¶åŠ é€Ÿ</h2><p>ç¡¬ä»¶åŠ é€Ÿä¸»è¦æ˜¯è€ƒè™‘å¤šæ ¸æ€§èƒ½åŠ é€Ÿå’Œå†…å­˜ä¸Šçš„ä½¿ç”¨ã€‚è¿™ä¸ªä¸ç”¨å¤šè¯´ï¼Œè®¾å¤‡è¶Šå¥½è½¯ä»¶æ€§èƒ½ä¹Ÿä¼šè¶Šå¥½ã€‚</p><h2 id="åˆ†å¸ƒå¼ç¼–è¯‘"><a href="#åˆ†å¸ƒå¼ç¼–è¯‘" class="headerlink" title="åˆ†å¸ƒå¼ç¼–è¯‘"></a>åˆ†å¸ƒå¼ç¼–è¯‘</h2><p>å¯¹äºæœ¬åœ°å·¥ç¨‹æ²¡ä»€ä¹ˆç”¨ï¼Œå¦‚æœæŒç»­é›†æˆä¸Šçš„é¡¹ç›®åº”è¯¥ä¼šæœ‰å¸®åŠ©ã€‚</p><h2 id="ç›¸å…³æµ‹è¯•ç»“æœ"><a href="#ç›¸å…³æµ‹è¯•ç»“æœ" class="headerlink" title="ç›¸å…³æµ‹è¯•ç»“æœ"></a>ç›¸å…³æµ‹è¯•ç»“æœ</h2><h4 id="xcodeæ˜¾ç¤ºç¼–è¯‘æ—¶é—´"><a href="#xcodeæ˜¾ç¤ºç¼–è¯‘æ—¶é—´" class="headerlink" title="xcodeæ˜¾ç¤ºç¼–è¯‘æ—¶é—´"></a>xcodeæ˜¾ç¤ºç¼–è¯‘æ—¶é—´</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>defaults write com.apple.dt.Xcode ShowBuildOperationDuration YES<br></code></pre></td></tr></table></figure><h4 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h4><p>å¤„ç†å™¨ï¼š2.7 GHz Intel Core i5 </p><p>å†…å­˜ï¼š8 GB 1867 MHz DDR3 </p><p>ç›®æ ‡é¡¹ç›®ï¼š ä¸œå®¶</p><p>æµ‹è¯•è¿‡ç¨‹ï¼špod update ,clean,build</p><h4 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h4><p>| ç›¸å…³æ“ä½œ                                                                      | ç¼–è¯‘æ—¶é—´ï¼ˆs)  |</p><p>| â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€” |</p><p>| Optimization Level = Noneï¼Œçº¿ç¨‹æ•° = 4ï¼Œå…¨æ¶æ„  | 608.897         |</p><p>| Optimization Level è®¾ä¸ºFastest                                | 683.089         |</p><p>| ç¼–è¯‘çº¿ç¨‹æ•°è®¾ä¸º8                                                          | 581.908         |</p><p>| å•ä¸ªæ¶æ„(arm64)                                                          | 358.189         |</p><p>| ccache                                                                           |                        |</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://www.jianshu.com/p/3b01979b2bf3" target="_blank" rel="noopener">å¦‚ä½•åŠ å¿«XCodeç¼–è¯‘é€Ÿåº¦ï¼Ÿ</a></p><p><a href="https://www.zybuluo.com/qidiandasheng/note/587124" target="_blank" rel="noopener">å¦‚ä½•åŠ å¿«ç¼–è¯‘é€Ÿåº¦</a></p><p><a href="https://bestswifter.com/improve_compile_speed/" target="_blank" rel="noopener">å¦‚ä½•å°† iOS å·¥ç¨‹æ‰“åŒ…é€Ÿåº¦æå‡åå€ä»¥ä¸Š</a></p><p><a href="https://www.jianshu.com/p/cd923dd1890a" target="_blank" rel="noopener">@import vs #import</a></p><p><a href="https://www.jianshu.com/p/53b2e3d203a9" target="_blank" rel="noopener">ccache è®©ä½ çš„ç¼–è¯‘æ—¶é—´é£èµ·æ¥</a></p><p><a href="https://juejin.im/post/59539377f265da6c415f064d" target="_blank" rel="noopener">[è´èŠç§‘æŠ€]å¦‚ä½•å°† iOS é¡¹ç›®çš„ç¼–è¯‘é€Ÿåº¦æé«˜5å€</a></p><p><a href="https://www.zybuluo.com/qidiandasheng/note/595740" target="_blank" rel="noopener">PodäºŒè¿›åˆ¶åŒ–</a></p><p><a href="http://www.dzpqzb.com/2015/07/30/2015-07-30-fen-bu-shi-bian-yi-iosyan-jiu/" target="_blank" rel="noopener">åˆ†å¸ƒå¼ç¼–è¯‘iosç ”ç©¶</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>iOSä¸­çš„è½¬åœºå®ç°åŠå°è£…</title>
      <link href="2018/05/03/iOS%E4%B8%AD%E7%9A%84%E8%BD%AC%E5%9C%BA%E5%AE%9E%E7%8E%B0%E5%8F%8A%E5%B0%81%E8%A3%85/"/>
      <url>2018/05/03/iOS%E4%B8%AD%E7%9A%84%E8%BD%AC%E5%9C%BA%E5%AE%9E%E7%8E%B0%E5%8F%8A%E5%B0%81%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h2 id="å…³äºè½¬åœº"><a href="#å…³äºè½¬åœº" class="headerlink" title="å…³äºè½¬åœº"></a>å…³äºè½¬åœº</h2><p>è½¬åœºæ˜¯ä¸¤ä¸ª<code>viewcontroller</code>åˆ‡æ¢ä¹‹é—´å‘ç”Ÿçš„åŠ¨ç”»æ•ˆæœã€‚iOSç³»ç»Ÿé»˜è®¤æä¾›çš„è½¬åœºæ•ˆæœåƒ<code>UINavigationController</code> <code>push &amp; pop</code>æ•ˆæœï¼Œ<code>UITabBarController</code> tabåˆ‡æ¢æ•ˆæœï¼Œä»¥åŠæ¨¡æ€å¼¹çª—<code>present &amp; dismiss</code>æ•ˆæœã€‚ç›®å‰è½¬åœºæœ‰ä¸¤ç§å½¢å¼ï¼Œæ™®é€šè½¬åœº å’Œ äº¤äº’å¼è½¬åœºï¼ˆåŸºäºæ‰‹åŠ¿æˆ–è€…å…¶ä»–æ–¹å¼ï¼‰ã€‚</p><h2 id="å¦‚ä½•å®ç°"><a href="#å¦‚ä½•å®ç°" class="headerlink" title="å¦‚ä½•å®ç°"></a>å¦‚ä½•å®ç°</h2><p>æˆ‘ä»¬ç”¨<code>UINavigationController</code>ä¸¾ä¾‹å­ï¼Œ<code>UINavigationControllerDelegate</code>æœ‰å…³è½¬åœºæœ‰ä¸¤ä¸ªåè®®ã€‚</p><h3 id="æ™®é€šè½¬åœº"><a href="#æ™®é€šè½¬åœº" class="headerlink" title="æ™®é€šè½¬åœº"></a>æ™®é€šè½¬åœº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">- (id&lt;UIViewControllerAnimatedTransitioning&gt;)<br>   navigationController:(UINavigationController *)navigationController <br>  animationControllerForOperation:(UINavigationControllerOperation)operation  fromViewController:(UIViewController *)fromVC <br>    toViewController:(UIViewController *)toVC;<br></code></pre></td></tr></table></figure><p>æ™®é€šè½¬åœºéœ€è¦å®ç°<code>UIViewControllerInteractiveTransitioning</code>åè®®çš„å¯¹è±¡ã€‚<code>UIViewControllerInteractiveTransitioning</code>åè®®ä¸­éœ€è¦å®ç°ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯è¿”å›è½¬åœºæ—¶é•¿ï¼Œå¦ä¸€ä¸ªæä¾›è½¬åœºä¸Šä¸‹æ–‡æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">- (NSTimeInterval)transitionDuration:(nullable id &lt;UIViewControllerContextTransitioning&gt;)transitionContext;<br><br>- (void)animateTransition:(id &lt;UIViewControllerContextTransitioning&gt;)transitionContext;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦é‡ç‚¹äº†è§£<code>transitionContext</code>èƒ½ç»™æˆ‘ä»¬æä¾›å“ªäº›å¿…è¦ä¿¡æ¯ã€‚æ ¹æ®<code>UIViewControllerContextTransitioning</code>åè®®æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ¥æºæ§åˆ¶å™¨ï¼ˆ<code>fromViewController</code>ï¼‰ä»¥åŠç›®æ ‡æ§åˆ¶å™¨ï¼ˆ<code>toViewController</code>ï¼‰ï¼Œæ¥æºè§†å›¾ï¼ˆ<code>fromView</code>ï¼‰ä»¥åŠç›®æ ‡è§†å›¾ï¼ˆ<code>toView</code>ï¼‰ï¼Œè½¬åœºå®¹å™¨è§†å›¾ï¼ˆ<code>containerView</code>ï¼‰ã€‚æœ‰è¿™äº›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå·²ç»è¶³å¤Ÿå®ç°åŠ¨ç”»äº†ã€‚</p><h3 id="äº¤äº’å¼è½¬åœº"><a href="#äº¤äº’å¼è½¬åœº" class="headerlink" title="äº¤äº’å¼è½¬åœº"></a>äº¤äº’å¼è½¬åœº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs objective-c">- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)navigationController:(UINavigationController *)navigationController<br>                          interactionControllerForAnimationController:(id &lt;UIViewControllerAnimatedTransitioning&gt;) animationController NS_AVAILABLE_IOS(7_0);<br></code></pre></td></tr></table></figure><p>äº¤äº’å¼è½¬åœºéœ€è¦å®ç°  <code>UIViewControllerInteractiveTransitioning</code>åè®®çš„å¯¹è±¡ï¼Œè¯¥åè®®æ ¸å¿ƒæ–¹æ³•æ˜¯</p><p><code>\- (void)startInteractiveTransition:(id &lt;UIViewControllerContextTransitioning&gt;)transitionContext;</code>ã€‚æˆ‘ä»¬ä¸€èˆ¬ä¸è‡ªå·±å®ç°<code>UIViewControllerInteractiveTransitioning</code>åè®®ï¼Œè€Œæ˜¯ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å·²å®ç°è¯¥åè®®çš„ç±»<code>UIPercentDrivenInteractiveTransition</code>ã€‚<code>UIPercentDrivenInteractiveTransition</code>æ–¹ä¾¿ä¹‹å¤„åœ¨äºå®ƒå¯ä»¥åŸºäºæ™®é€šè½¬åœºå®ç°äº¤äº’å¼è½¬åœºã€‚è€Œä½ éœ€è¦åšçš„æ˜¯åœ¨è½¬åœºè¿‡ç¨‹ä¸­æ›´æ–°è½¬åœºè¿›åº¦ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å…¶ä»–ä¸¤ç§å½¢å¼çš„è½¬åœºå®ç°æ–¹å¼ä¸ä¸Šé¢ç±»ä¼¼ã€‚</p><p>å¯¹äºæ¨¡æ€çª—éœ€è¦å®ç°<code>UIViewControllerTransitioningDelegate</code>ä¸­å››ä¸ªå…³äºè½¬åœºçš„åè®®ã€‚</p><p>å¯¹äº<code>UITabBarController</code>éœ€è¦å®ç°<code>UITabBarControllerDelegate</code>ä¸­ä¸¤ä¸ªå…³äºè½¬åœºçš„åè®®ã€‚</p><h2 id="å…³äºå°è£…"><a href="#å…³äºå°è£…" class="headerlink" title="å…³äºå°è£…"></a>å…³äºå°è£…</h2><p>æŒ‰ç…§ä¸Šé¢å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬ä¼šå‘ç°è‹¥å¹²ä¸ªé—®é¢˜ã€‚</p><ul><li><p>æ¯ä¸€ä¸ªå®ç°<code>UIViewControllerAnimatedTransitioning</code>åè®®å¯¹è±¡ï¼Œéƒ½éœ€è¦ä»è½¬åœºä¸Šä¸‹æ–‡è·å–å¯¹åº”çš„ä¿¡æ¯ï¼Œè¿™äº›ä»£ç éƒ½æ˜¯ç›¸åŒçš„ï¼Œå”¯ä¸€çœŸæ­£çš„ä¸åŒåœ¨äºåŠ¨ç”»éƒ¨åˆ†ã€‚</p></li><li><p><code>ViewController</code>ä¸­å®ç°è½¬åœºç›¸å…³çš„ä»£ç†ï¼Œåœ¨ä»£ç ä¸­è¿‡äºåˆ†æ•£ã€‚</p></li></ul><p>æ ¹æ®ä¸Šé¢å­˜åœ¨çš„é—®é¢˜å°è£…äº†åº“<a href="https://github.com/persenlee/PLTransition" target="_blank" rel="noopener">PLTransition</a>ï¼Œå…·ä½“ä¸€äº›ä¾‹å­æ•ˆæœå¦‚ä¸‹ã€‚</p><p><img src="https://i.loli.net/2020/04/30/hCWnQFGvZBYoO7j.gif" alt="GIFå›¾åƒ-8124270787A5-1.gif"></p><p><img src="https://i.loli.net/2020/04/30/kErLIupNjmgPl5c.gif" alt="GIFå›¾åƒ-4543B455C1B7-1.gif"></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ul><li><p>è½¬åœºå¯ä»¥ä¸CoreImageï¼ŒCoreAnimation ç»“åˆç”Ÿæˆå¾ˆå¤šé…·ç‚«äº¤äº’æ•ˆæœï¼Œå¯ä»¥çœ‹çœ‹è¿™ä¸ªåº“<a href="https://github.com/shu223/AnimatedTransitionGallery" target="_blank" rel="noopener">AnimatedTransitionGallery</a>å®ç°çš„ä¸€äº›æ•ˆæœã€‚</p></li><li><p>å¦‚ä½•å°†å°è£…çš„åº“åº”ç”¨åˆ°å…·ä½“é¡¹ç›®é‡Œï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šæ”¹è¿›çš„åœ°æ–¹ã€‚</p></li></ul>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
